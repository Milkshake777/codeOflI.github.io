<!DOCTYPE html>





<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.9.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicon128.ico?v=7.4.1">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicon32.ico?v=7.4.1">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicon16.ico?v=7.4.1">
  <link rel="mask-icon" href="/images/logo.svg?v=7.4.1" color="#222">
  <link rel="alternate" href="/atom.xml" title="nicolas" type="application/atom+xml">

<link rel="stylesheet" href="/css/main.css?v=7.4.1">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '7.4.1',
    exturl: false,
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    copycode: {"enable":true,"show_result":true,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":true},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: 'search.xml',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: '复制',
      copy_success: '复制成功',
      copy_failure: '复制失败'
    },
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="[TOC]六、DML语言的学习    ★                  插入语句                             修改语句                             删除语句                         七、DDL语言的学习       库和表的管理     √                     常见数据类型介绍  √">
<meta name="keywords" content="mysql">
<meta property="og:type" content="article">
<meta property="og:title" content="mysql">
<meta property="og:url" content="https://codeofli.github.io/2019/03/数据库/mysql/mysql/index.html">
<meta property="og:site_name" content="nicolas">
<meta property="og:description" content="[TOC]六、DML语言的学习    ★                  插入语句                             修改语句                             删除语句                         七、DDL语言的学习       库和表的管理     √                     常见数据类型介绍  √">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://codeofli.github.io/2019/03/数据库/mysql/mysql/2934349b033b5bb57f0eb50b36d3d539b700bc6e.jpg">
<meta property="og:image" content="https://pic.leetcode-cn.com/ad3df1c4ecc7d2dbe85f92cdde8ec9a731fdd20dc4c5629ecb372b21de26c682-1.jpg">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20181121113205147.jpg">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20181121113324478.jpg">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20181121113528273.jpg">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20181121113628764.jpg">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20181121113815360.jpg">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20181121113949992.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzM3OTg3MTUx,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20181121114058832.jpg">
<meta property="og:updated_time" content="2022-04-08T10:09:53.490Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="mysql">
<meta name="twitter:description" content="[TOC]六、DML语言的学习    ★                  插入语句                             修改语句                             删除语句                         七、DDL语言的学习       库和表的管理     √                     常见数据类型介绍  √">
<meta name="twitter:image" content="https://codeofli.github.io/2019/03/数据库/mysql/mysql/2934349b033b5bb57f0eb50b36d3d539b700bc6e.jpg">
  <link rel="canonical" href="https://codeofli.github.io/2019/03/数据库/mysql/mysql/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true,
    isPage: false,
    isArchive: false
  };
</script>

  <title>mysql | nicolas</title>
  








  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">nicolas</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">Yesterday you said tomorow.</p>
      
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
      
      
      
        
        <li class="menu-item menu-item-home">
      
    
      
      
        
      
        
      
        
      
    

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-about">
      
    
      
      
        
      
        
      
        
      
    

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-tags">
      
    
      
      
        
      
        
      
        
          
        
      
    

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签<span class="badge">29</span></a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-categories">
      
    
      
      
        
      
        
          
        
      
        
      
    

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类<span class="badge">10</span></a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-archives">
      
    
      
      
        
          
        
      
        
      
        
      
    

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档<span class="badge">40</span></a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

  <a href="https://github.com/codeOflI/LearningNotes" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
            

          <div id="content" class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://codeofli.github.io/2019/03/数据库/mysql/mysql/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="nicolas lee">
      <meta itemprop="description" content="Yesterday you said tomorow.">
      <meta itemprop="image" content="/assets/img/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="nicolas">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">mysql

          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              
                
              

              <time title="创建时间：2019-03-27 22:19:09" itemprop="dateCreated datePublished" datetime="2019-03-27T22:19:09+08:00">2019-03-27</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-04-08 18:09:53" itemprop="dateModified" datetime="2022-04-08T18:09:53+08:00">2022-04-08</time>
              </span>
            
          

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
          
          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
              
                <span class="post-meta-item-text">本文字数：</span>
              
              <span></span>
            </span>
          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>[TOC]</p><pre><code>六、DML语言的学习    ★             
    插入语句                        
    修改语句                        
    删除语句                        
七、DDL语言的学习  
    库和表的管理     √                
    常见数据类型介绍  √          
    常见约束        √            
八、TCL语言的学习
    事务和事务处理                 
九、视图的讲解           √
十、变量                      
十一、存储过程和函数   
十二、流程控制结构       </code></pre><a id="more"></a>
<h1 id="数据库简介"><a href="#数据库简介" class="headerlink" title="数据库简介"></a>数据库简介</h1><p><a href="https://www.runoob.com/mysql/mysql-tutorial.html" target="_blank" rel="noopener">MySQL - 菜鸟教程</a></p>
<h2 id="数据库相关概念"><a href="#数据库相关概念" class="headerlink" title="数据库相关概念"></a>数据库相关概念</h2><h3 id="数据库的好处"><a href="#数据库的好处" class="headerlink" title="数据库的好处"></a>数据库的好处</h3><pre><code>1.持久化数据到 本地
2.可以实现结构化查询，方便管理</code></pre><h3 id="数据库相关概念-1"><a href="#数据库相关概念-1" class="headerlink" title="数据库相关概念"></a>数据库相关概念</h3><pre><code>1、DB：数据库，保存一组有组织的数据的容器
2、DBMS：数据库管理系统，又称为数据库软件（产品），用于管理DB中的数据
3、SQL:结构化查询语言，用于和DBMS通信的语言</code></pre><h3 id="数据库存储数据的特点"><a href="#数据库存储数据的特点" class="headerlink" title="数据库存储数据的特点"></a>数据库存储数据的特点</h3><pre><code>1、将数据放到表中，表再放到库中
2、一个数据库中可以有多个表，每个表都有一个的名字，用来标识自己。表名具有唯一性。
3、表具有一些特性，这些特性定义了数据在表中如何存储，类似java中 “类”的设计。
4、表由列组成，我们也称为字段。所有表都是由一个或多个列组成的，每一列类似java 中的”属性”
5、表中的数据是按行存储的，每一行类似于java中的“对象”。</code></pre><h2 id="MySQL产品的介绍和安装"><a href="#MySQL产品的介绍和安装" class="headerlink" title="MySQL产品的介绍和安装"></a>MySQL产品的介绍和安装</h2><h3 id="MySQL服务的启动和停止"><a href="#MySQL服务的启动和停止" class="headerlink" title="MySQL服务的启动和停止"></a>MySQL服务的启动和停止</h3><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">方式一：计算机——右击管理——服务</span><br><span class="line">方式二：通过管理员身份运行</span><br><span class="line"><span class="built_in">net</span> <span class="built_in">start</span> 服务名（启动服务）</span><br><span class="line"><span class="built_in">net</span> stop 服务名（停止服务）</span><br></pre></td></tr></table></figure>

<h3 id="MySQL服务的登录和退出"><a href="#MySQL服务的登录和退出" class="headerlink" title="MySQL服务的登录和退出"></a>MySQL服务的登录和退出</h3><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">方式一：通过mysql自带的客户端</span><br><span class="line">只限<span class="built_in">于root</span>用户</span><br></pre></td></tr></table></figure>

<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">方式二：通过windows自带的客户端</span><br><span class="line">登录：</span><br><span class="line">mysql 【-h主机名 -P端口号 】-u用户名 -p密码</span><br><span class="line"></span><br><span class="line">退出：</span><br><span class="line"><span class="keyword">exit</span>或ctrl+C</span><br></pre></td></tr></table></figure>

<h2 id="SQL的语言分类"><a href="#SQL的语言分类" class="headerlink" title="SQL的语言分类"></a>SQL的语言分类</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">DQL（Data Query Language）：数据查询语言</span><br><span class="line">	<span class="keyword">select</span> </span><br><span class="line">DML(<span class="keyword">Data</span> Manipulate <span class="keyword">Language</span>):数据操作语言</span><br><span class="line">	<span class="keyword">insert</span> 、<span class="keyword">update</span>、<span class="keyword">delete</span></span><br><span class="line"><span class="keyword">DDL</span>（<span class="keyword">Data</span> <span class="keyword">Define</span> Languge）：数据定义语言</span><br><span class="line">	<span class="keyword">create</span>、<span class="keyword">drop</span>、<span class="keyword">alter</span></span><br><span class="line">TCL（<span class="keyword">Transaction</span> Control <span class="keyword">Language</span>）：事务控制语言</span><br><span class="line">	<span class="keyword">commit</span>、<span class="keyword">rollback</span></span><br></pre></td></tr></table></figure>

<h2 id="MySQL的语法规范"><a href="#MySQL的语法规范" class="headerlink" title="MySQL的语法规范"></a>MySQL的语法规范</h2><p>1.不区分大小写,但建议关键字大写，表名、列名小写<br>2.每条命令最好用分号结尾<br>3.每条命令根据需要，可以进行缩进 或换行<br>4.注释</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">单行注释：#注释文字</span><br><span class="line">单行注释：-- 注释文字</span><br><span class="line">多行注释：/* 注释文字  */</span><br></pre></td></tr></table></figure>

<h1 id="查询-DQL语言"><a href="#查询-DQL语言" class="headerlink" title="查询-DQL语言"></a>查询-DQL语言</h1><h2 id="基础查询"><a href="#基础查询" class="headerlink" title="基础查询"></a>基础查询</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">语法：</span><br><span class="line"><span class="keyword">SELECT</span> 要查询的东西【<span class="keyword">FROM</span> 表名】;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">类似于Java中 :System.out.println(要打印的东西);</span><br><span class="line">特点：</span><br><span class="line">①通过<span class="keyword">select</span>查询完的结果 ，是一个虚拟的表格，不是真实存在</span><br><span class="line">② 要查询的东西 可以是常量值、可以是表达式、可以是字段、可以是函数</span><br></pre></td></tr></table></figure>

<h3 id="DISTINCT"><a href="#DISTINCT" class="headerlink" title="DISTINCT"></a>DISTINCT</h3><p><strong>相同值只会出现一次</strong>。它作用于所有列，也就是说<strong>所有列的值都相同才算相同。</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> col1, col2</span><br><span class="line"><span class="keyword">FROM</span> mytable;</span><br></pre></td></tr></table></figure>

<h2 id="计算字段"><a href="#计算字段" class="headerlink" title="计算字段"></a>计算字段</h2><p>在<strong>数据库服务器上完成数据的转换和格式化</strong>的工作往往比客户端上快得多，并且转换和格式化后的<strong>数据量更少的话可以减少网络通信量。</strong></p>
<p>计算字段通常需要使用  <strong>AS</strong>  来取别名，否则输出的时候字段名为计算表达式。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> col1 * col2 <span class="keyword">AS</span> <span class="keyword">alias</span></span><br><span class="line"><span class="keyword">FROM</span> mytable;</span><br><span class="line"></span><br><span class="line"><span class="comment">#起别名</span></span><br><span class="line"><span class="comment">#方式一：使用as</span></span><br><span class="line"><span class="keyword">SELECT</span> last_name <span class="keyword">AS</span> 姓,first_name <span class="keyword">AS</span> 名 <span class="keyword">FROM</span> employees;</span><br><span class="line"><span class="comment">#方拾二：省略as(使用空格)</span></span><br><span class="line"><span class="keyword">SELECT</span> last_name 姓,first_name 名 <span class="keyword">FROM</span> employees;</span><br><span class="line"><span class="comment">#包含特殊字符使用""('')标注为字符串</span></span><br><span class="line"><span class="keyword">SELECT</span> last_name <span class="string">"姓 X"</span>,first_name 名 <span class="keyword">FROM</span> employees;</span><br></pre></td></tr></table></figure>

<p><strong>CONCAT()</strong>  用于<strong>连接两个字段</strong>。许多数据库会使用空格把一个值填充为列宽，因此连接的结果会出现一些不必要的空格，使用 <strong>TRIM()</strong> 可以去除首尾空格。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">CONCAT</span>(<span class="keyword">TRIM</span>(col1), <span class="string">'('</span>, <span class="keyword">TRIM</span>(col2), <span class="string">')'</span>) <span class="keyword">AS</span> concat_col</span><br><span class="line"><span class="keyword">FROM</span> mytable;  </span><br><span class="line"></span><br><span class="line"><span class="comment"># +</span></span><br><span class="line"><span class="comment">#只要有一方为null，则+和拼接都为null</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">CONCAT</span>(first_name,<span class="string">' '</span>,last_name) <span class="string">`name`</span> <span class="keyword">FROM</span> emplyees;</span><br></pre></td></tr></table></figure>

<h2 id="条件查询"><a href="#条件查询" class="headerlink" title="条件查询"></a>条件查询</h2><p>where 关键字</p>
<p>条件查询：根据条件过滤原始表的数据，查询到想要的数据<br>语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 要查询的字段|表达式|常量值|函数</span><br><span class="line"><span class="keyword">from</span> 表</span><br><span class="line"><span class="keyword">where</span> 条件;</span><br></pre></td></tr></table></figure>

<p>下表显示了 WHERE 子句可用的操作符</p>
<table>
<thead>
<tr>
<th align="center">操作符</th>
<th align="center">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="center">=</td>
<td align="center">等于</td>
</tr>
<tr>
<td align="center">&lt;</td>
<td align="center">小于</td>
</tr>
<tr>
<td align="center">&gt;</td>
<td align="center">大于</td>
</tr>
<tr>
<td align="center">&lt;&gt; , !=</td>
<td align="center">不等于</td>
</tr>
<tr>
<td align="center">&lt;= , !&gt;</td>
<td align="center">小于等于</td>
</tr>
<tr>
<td align="center">&gt;= , !&lt;</td>
<td align="center">大于等于</td>
</tr>
<tr>
<td align="center">BETWEEN</td>
<td align="center">在两个值之间</td>
</tr>
<tr>
<td align="center">IS NULL</td>
<td align="center">为 NULL 值</td>
</tr>
</tbody></table>
<p>应该注意到，<strong>NULL 与 0、空字符串都不同。</strong></p>
<p><strong>AND 和 OR</strong>  用于<strong>连接多个过滤条件</strong>。优先处理 AND，当一个过滤表达式涉及到多个 AND 和 OR 时，可以使用 () 来决定优先级，使得优先级关系更清晰。</p>
<p><strong>IN</strong>  操作符用于<strong>匹配一组值</strong>，其后<strong>也可以接一个 SELECT 子句</strong>，从而匹配子查询得到的一组值。</p>
<p><strong>NOT</strong>  操作符用于否定一个条件。</p>
<p>分类：</p>
<h3 id="1条件表达式"><a href="#1条件表达式" class="headerlink" title="1条件表达式"></a>1条件表达式</h3><p>​    示例：<code>salary &gt; 10000</code><br>​    条件运算符：<br>​    <code>&gt; ,&lt; ,&gt;=, &lt;=, =, !=, &lt;&gt;</code></p>
<h3 id="2逻辑表达式"><a href="#2逻辑表达式" class="headerlink" title="2逻辑表达式"></a>2逻辑表达式</h3><p>示例：<code>salary &gt;10000 &amp;&amp; salary &lt; 20000</code></p>
<p>逻辑运算符：</p>
<p>and（&amp;&amp;）:两个条件如果同时成立，结果为true，否则为false<br>or(||)：两个条件只要有一个成立，结果为true，否则为false<br>not(!)：如果条件成立，则not后为false，否则为true</p>
<p><code>between and</code> 等价于并简化了 &gt;=   &lt;= 语句<br><code>in</code> 判断某字段的值是否属于in列表中的某一项，in中列表值类型必须一致或兼容</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM employees WHERE job_id IN(&apos;IT_PROT&apos;,&apos;AD_VP&apos;);</span><br></pre></td></tr></table></figure>

<p><code>is null| is not null</code><br>只能判断null值，= 和&lt;&gt; 不能判断null值<br>安全等于<code>&lt;=&gt;</code><br>既能判断是否为null，也能判断其他类型</p>
<h3 id="3模糊查询"><a href="#3模糊查询" class="headerlink" title="3模糊查询"></a>3模糊查询</h3><p>LIKE</p>
<h4 id="通配符"><a href="#通配符" class="headerlink" title="通配符"></a>通配符</h4><p>通配符也是用在过滤语句中，但它只能用于文本字段。</p>
<ul>
<li><strong>%</strong>  匹配 &gt;=0 个任意字符；</li>
<li><strong>_</strong>  匹配 ==1 个任意字符；</li>
<li><strong>[ ]</strong>  可以<strong>匹配集合内的字符</strong>，例如 [ab] 将匹配字符 a 或者 b。用脱字符 ^ 可以对其进行否定，也就是不匹配集合内的字符。</li>
<li>特殊字符：使用转义字符</li>
</ul>
<p>使用 <strong>Like 来进行通配符匹配。</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> mytable</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">col</span> <span class="keyword">LIKE</span> <span class="string">'[^AB]%'</span>; <span class="comment">-- 不以 A 和 B 开头的任意文本</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>不要滥用通配符，==<strong>通配符位于开头处匹配会非常慢。</strong>==</p>
</blockquote>
<h2 id="排序查询"><a href="#排序查询" class="headerlink" title="排序查询"></a>排序查询</h2><ul>
<li><strong>ASC</strong> : 升序(默认)</li>
<li><strong>DESC</strong> : 降序</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">语法：</span><br><span class="line"><span class="keyword">select</span></span><br><span class="line">	要查询的东西</span><br><span class="line"><span class="keyword">from</span> 表</span><br><span class="line"><span class="keyword">where</span> 条件	</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> 排序的字段|表达式|函数|别名 【<span class="keyword">asc</span>|<span class="keyword">desc</span>】,次要排序内容(通前面格式一致)</span><br><span class="line"><span class="comment">#默认升序</span></span><br></pre></td></tr></table></figure>

<h2 id="常见函数"><a href="#常见函数" class="headerlink" title="常见函数"></a>常见函数</h2><p>各个 DBMS 的函数都是不相同的，因此不可移植，以下主要是 MySQL 的函数。</p>
<ul>
<li><p>调用</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 函数名（实参列表）【<span class="keyword">form</span> 表】</span><br></pre></td></tr></table></figure>
</li>
<li><p>函数可以嵌套</p>
</li>
<li><p><strong>分组函数，聚合函数，汇总函数</strong>，是<strong>同一种概念的不同称呼</strong>。都是指<strong>对一组值执行计算并返回单一的值</strong>。</p>
</li>
</ul>
<h3 id="1单行函数"><a href="#1单行函数" class="headerlink" title="1单行函数"></a>1单行函数</h3><p>单行函数分为：字符串函数、数值函数、日期函数、转换函数、通用函数。<strong>所有的单行函数可以在SQL语句的任意位置上出现。</strong></p>
<h4 id="1、字符函数"><a href="#1、字符函数" class="headerlink" title="1、字符函数"></a>1、字符函数</h4><ul>
<li>concat()拼接（字符串）    </li>
<li>substr()截取子串</li>
<li>upper()转换成大写    </li>
<li>lower()转换成小写    </li>
<li>trim()去前后指定的空格和字符    </li>
<li>ltrim()去左边空格    </li>
<li>rtrim()去右边空格    </li>
<li>replace()替换    </li>
<li>lpad()左填充    </li>
<li>rpad()右填充    </li>
<li>instr()返回子串第一次出现的索引，如果找不到返回0        </li>
<li>length() 获取<strong>字节</strong>个数 </li>
</ul>
<h4 id="2数值函数"><a href="#2数值函数" class="headerlink" title="2数值函数"></a>2数值函数</h4><table>
<thead>
<tr>
<th align="center">函数</th>
<th align="center">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="center">round()</td>
<td align="center">四舍五入</td>
</tr>
<tr>
<td align="center">floor()</td>
<td align="center">向下取整</td>
</tr>
<tr>
<td align="center">ceil()</td>
<td align="center">向上取整</td>
</tr>
<tr>
<td align="center">ABS()</td>
<td align="center">绝对值</td>
</tr>
<tr>
<td align="center">SQRT()</td>
<td align="center">平方根</td>
</tr>
<tr>
<td align="center">MOD()</td>
<td align="center">余数</td>
</tr>
<tr>
<td align="center">EXP()</td>
<td align="center">指数</td>
</tr>
<tr>
<td align="center">PI()</td>
<td align="center">圆周率</td>
</tr>
<tr>
<td align="center">RAND()</td>
<td align="center">随机数</td>
</tr>
<tr>
<td align="center">SIN()</td>
<td align="center">正弦</td>
</tr>
<tr>
<td align="center">COS()</td>
<td align="center">余弦</td>
</tr>
<tr>
<td align="center">TAN()</td>
<td align="center">正切</td>
</tr>
<tr>
<td align="center">mod()</td>
<td align="center">取余 mod(a,b) = a-a/b*b<br>（有效解决负数问题）</td>
</tr>
<tr>
<td align="center">truncate()</td>
<td align="center">截断</td>
</tr>
</tbody></table>
<p>​    </p>
<h4 id="3日期函数"><a href="#3日期函数" class="headerlink" title="3日期函数"></a>3日期函数</h4><ul>
<li>日期格式: YYYY-MM-DD</li>
<li>时间格式: HH:MM:SS</li>
</ul>
<table>
<thead>
<tr>
<th align="center">函 数</th>
<th align="left">说 明</th>
</tr>
</thead>
<tbody><tr>
<td align="center">AddDate()</td>
<td align="left">增加一个日期(天、周等)</td>
</tr>
<tr>
<td align="center">AddTime()</td>
<td align="left">增加一个时间(时、分等)</td>
</tr>
<tr>
<td align="center">CurDate()</td>
<td align="left">返回当前系统日期</td>
</tr>
<tr>
<td align="center">CurTime()</td>
<td align="left">返回当前系统时间</td>
</tr>
<tr>
<td align="center">Date()</td>
<td align="left">返回日期时间的日期部分</td>
</tr>
<tr>
<td align="center">DateDiff()</td>
<td align="left">计算两个日期之差</td>
</tr>
<tr>
<td align="center">Date_Add()</td>
<td align="left">高度灵活的日期运算函数</td>
</tr>
<tr>
<td align="center">Date_Format()</td>
<td align="left">返回一个格式化的日期或时间(字符)串</td>
</tr>
<tr>
<td align="center">Day()</td>
<td align="left">返回一个日期的天数部分</td>
</tr>
<tr>
<td align="center">DayOfWeek()</td>
<td align="left">对于一个日期，返回对应的星期几</td>
</tr>
<tr>
<td align="center">Hour()</td>
<td align="left">返回一个时间的小时部分</td>
</tr>
<tr>
<td align="center">Minute()</td>
<td align="left">返回一个时间的分钟部分</td>
</tr>
<tr>
<td align="center">Month()</td>
<td align="left">返回一个日期的月份部分</td>
</tr>
<tr>
<td align="center">Now()</td>
<td align="left">返回当前（系统）日期和时间</td>
</tr>
<tr>
<td align="center">Second()</td>
<td align="left">返回一个时间的秒部分</td>
</tr>
<tr>
<td align="center">Time()</td>
<td align="left">返回一个日期时间的时间部分</td>
</tr>
<tr>
<td align="center">Year()</td>
<td align="left">返回一个日期的年份部分</td>
</tr>
<tr>
<td align="center">str_to_date()</td>
<td align="left">将字符转换成日期</td>
</tr>
<tr>
<td align="center"></td>
<td align="left"></td>
</tr>
</tbody></table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT NOW();</span><br><span class="line">2018-4-14 20:25:11</span><br></pre></td></tr></table></figure>

<h4 id="4、流程控制函数"><a href="#4、流程控制函数" class="headerlink" title="4、流程控制函数"></a>4、流程控制函数</h4><p>​    if (条件表达式，成立值，false值)处理双分支 ，和三元运算符相当<br>​    case语句 处理多分支<br>​        情况1：处理等值判断</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">case 要判断的字段或表达式</span><br><span class="line">when 常量1 then 要显示的值1或语句1;</span><br><span class="line">when 常量2 then 要显示的值2或语句2;</span><br><span class="line">···</span><br><span class="line">else 要显示的值n或语句n;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> salary	init,department_id,</span><br><span class="line"><span class="keyword">CASE</span> department_id</span><br><span class="line"><span class="keyword">WHEN</span> <span class="number">30</span> <span class="keyword">THEN</span> salary*<span class="number">1.1</span></span><br><span class="line"><span class="keyword">WHEN</span> <span class="number">40</span> <span class="keyword">THEN</span> salary*<span class="number">1.2</span></span><br><span class="line"><span class="keyword">WHEN</span> <span class="number">50</span> <span class="keyword">THEN</span> salary*<span class="number">1.3</span></span><br><span class="line"><span class="keyword">ELSE</span> salary</span><br><span class="line"><span class="keyword">END</span> <span class="keyword">AS</span> <span class="string">`new`</span></span><br><span class="line"><span class="keyword">FROM</span> employees;</span><br></pre></td></tr></table></figure>

<pre><code>情况2：处理条件判断</code></pre><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">case</span><br><span class="line">when 常量1 then 要显示的值1或语句1;</span><br><span class="line">when 常量2 then 要显示的值2或语句2;</span><br><span class="line">···</span><br><span class="line">else 要显示的值n或语句n;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">#相当于多重if语句</span></span><br><span class="line"><span class="keyword">SELECT</span> salary,</span><br><span class="line"><span class="keyword">CASE</span></span><br><span class="line"><span class="keyword">WHEN</span> salary &gt; <span class="number">20000</span> <span class="keyword">THEN</span> <span class="string">'a'</span></span><br><span class="line"><span class="keyword">WHEN</span> salary &gt; <span class="number">15000</span> <span class="keyword">THEN</span> <span class="string">'b'</span></span><br><span class="line"><span class="keyword">WHEN</span> salary &gt; <span class="number">10000</span> <span class="keyword">THEN</span> <span class="string">'b'</span></span><br><span class="line"><span class="keyword">ELSE</span> <span class="string">'d'</span></span><br><span class="line"><span class="keyword">END</span> <span class="keyword">AS</span>  grade</span><br><span class="line"><span class="keyword">FROM</span> employees;</span><br></pre></td></tr></table></figure>

<h4 id="5、其他函数"><a href="#5、其他函数" class="headerlink" title="5、其他函数"></a>5、其他函数</h4><p>​    version版本<br>​    database当前库<br>​    user当前连接用户</p>
<h3 id="2分组-汇总，聚合-函数"><a href="#2分组-汇总，聚合-函数" class="headerlink" title="2分组(汇总，聚合)函数"></a>2分组(汇总，聚合)函数</h3><p><em>聚合函数</em>：<strong>对一组值执行计算并返回单一的值</strong></p>
<p>又称<strong>统计函数</strong>,也成<strong>汇总函数</strong>，也称为<strong>聚合函数</strong>;分组函数是对<strong>表中一组记录进行操作</strong>，每组值<strong>返回一个结果</strong>，即首先要对表记录进行分组，然后再进对表记录进行分组，然后在进行操作汇总，每组返回一个结果，<strong>分组是可能是整个表分为一个组</strong>，也可能根据条件分成多组。</p>
<table>
<thead>
<tr>
<th align="center">函 数</th>
<th align="center">说 明</th>
</tr>
</thead>
<tbody><tr>
<td align="center">AVG()</td>
<td align="center">返回某列的平均值</td>
</tr>
<tr>
<td align="center">COUNT()</td>
<td align="center">返回某列的行数</td>
</tr>
<tr>
<td align="center">MAX()</td>
<td align="center">返回某列的最大值</td>
</tr>
<tr>
<td align="center">MIN()</td>
<td align="center">返回某列的最小值</td>
</tr>
<tr>
<td align="center">SUM()</td>
<td align="center">返回某列值之和</td>
</tr>
</tbody></table>
<p>AVG() 会忽略 NULL 行。</p>
<p>使用 DISTINCT 可以让汇总函数值汇总不同的值。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">AVG</span>(<span class="keyword">DISTINCT</span> col1) <span class="keyword">AS</span> avg_col</span><br><span class="line"><span class="keyword">FROM</span> mytable;</span><br></pre></td></tr></table></figure>

<p>特点：</p>
<ol>
<li><p>以上五个分组函数都忽略null值，除了<code>count(*)</code></p>
</li>
<li><p>sum和<code>avg</code>一般用于处理数值型<br>max、min、count可以处理任何数据类型</p>
</li>
<li><p>都可以<strong>搭配distinct使用，用于统计去重后的结果</strong></p>
</li>
<li><p>count的参数可以支持：<br>字段、<code>*</code>、常量值，一般放1</p>
<blockquote>
<p><strong>建议使用 count(*)</strong></p>
</blockquote>
</li>
<li><p>可以搭配group by使用</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">MAX</span>(column_name) <span class="keyword">FROM</span> table_name <span class="keyword">GROUP</span> <span class="keyword">BY</span> column_name;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h4 id="SQL-MAX-语法"><a href="#SQL-MAX-语法" class="headerlink" title="SQL MAX() 语法"></a>SQL MAX() 语法</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT MAX(column_name) FROM table_name;</span><br></pre></td></tr></table></figure>

<h2 id="分组查询"><a href="#分组查询" class="headerlink" title="分组查询"></a>分组查询</h2><p>GROUP BY 语句，分组就是把<strong>具有相同的数据值的行</strong>放在<strong>同一组</strong>中，即根据<strong>一个或多个列对结果集进行分组</strong>。</p>
<p>可以对同一分组数据<strong>使用汇总(分组)函数进行处理</strong>，在分组的列上我们<strong>可以使用 COUNT, SUM, AVG,等函数</strong>，例如求分组数据的平均值等。</p>
<p>GROUP BY <strong>自动按分组字段进行排序</strong>，ORDER BY <strong>也可以按汇总字段来进行排序。</strong></p>
<p>WHERE 过滤行，HAVING 过滤分组，<strong>行过滤应当先于分组过滤。</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT column_name, function(column_name)</span><br><span class="line">FROM table_name</span><br><span class="line">WHERE column_name operator value</span><br><span class="line">GROUP BY column_name </span><br><span class="line">HAVING  column_name operator;</span><br></pre></td></tr></table></figure>

<p><strong>分组规定:</strong></p>
<ul>
<li>GROUP BY 子句出现在 WHERE 子句之后，ORDER BY 子句之前；</li>
<li>除了<strong>汇总（分组）字段</strong>外，SELECT 语句中的<strong>每一字段都必须在 GROUP BY 子句中给出；</strong></li>
<li>NULL 的行会<strong>单独分为一组</strong>；</li>
<li>大多数 SQL 实现不支持 GROUP BY 列具有可变长度的数据类型。</li>
<li>having后可以支持别名</li>
</ul>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT * FROM employee_tbl;</span><br><span class="line">+----+--------+---------------------+--------+</span><br><span class="line">| id | name   | date                | signin |</span><br><span class="line">+----+--------+---------------------+--------+</span><br><span class="line">|  <span class="number">1</span> | 小明 | <span class="number">2016</span><span class="number">-04</span><span class="number">-22</span> <span class="number">15</span>:<span class="number">25</span>:<span class="number">33</span> |      <span class="number">1</span> |</span><br><span class="line">|  <span class="number">2</span> | 小王 | <span class="number">2016</span><span class="number">-04</span><span class="number">-20</span> <span class="number">15</span>:<span class="number">25</span>:<span class="number">47</span> |      <span class="number">3</span> |</span><br><span class="line">|  <span class="number">3</span> | 小丽 | <span class="number">2016</span><span class="number">-04</span><span class="number">-19</span> <span class="number">15</span>:<span class="number">26</span>:<span class="number">02</span> |      <span class="number">2</span> |</span><br><span class="line">|  <span class="number">4</span> | 小王 | <span class="number">2016</span><span class="number">-04</span><span class="number">-07</span> <span class="number">15</span>:<span class="number">26</span>:<span class="number">14</span> |      <span class="number">4</span> |</span><br><span class="line">|  <span class="number">5</span> | 小明 | <span class="number">2016</span><span class="number">-04</span><span class="number">-11</span> <span class="number">15</span>:<span class="number">26</span>:<span class="number">40</span> |      <span class="number">4</span> |</span><br><span class="line">|  <span class="number">6</span> | 小明 | <span class="number">2016</span><span class="number">-04</span><span class="number">-04</span> <span class="number">15</span>:<span class="number">26</span>:<span class="number">54</span> |      <span class="number">2</span> |</span><br><span class="line">+----+--------+---------------------+--------+</span><br><span class="line"><span class="number">6</span> rows <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>

<p>接下来我们使用 GROUP BY 语句 将数据表按名字进行分组，并统计每个人有多少条记录：</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT name, COUNT(<span class="strong">*) FROM   employee_tbl GROUP BY name;</span></span><br><span class="line"><span class="strong">+--------+----------+</span></span><br><span class="line"><span class="strong">| name   | COUNT(*</span>) |</span><br><span class="line"><span class="code">+--------+</span>----------+</span><br><span class="line">| 小丽 |        1 |</span><br><span class="line">| 小明 |        3 |</span><br><span class="line">| 小王 |        2 |</span><br><span class="line"><span class="code">+--------+</span>----------+</span><br><span class="line">3 rows in set (0.01 sec)</span><br></pre></td></tr></table></figure>

<h3 id="使用-WITH-ROLLUP"><a href="#使用-WITH-ROLLUP" class="headerlink" title="使用 WITH ROLLUP"></a>使用 WITH ROLLUP</h3><p>WITH ROLLUP 可以实现在<strong>分组统计数据基础上再进行相同的统计（SUM,AVG,COUNT…）。</strong></p>
<p>例如我们将以上的数据表按名字进行分组，再统计每个人登录的次数：</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT name, SUM(signin) as signin<span class="emphasis">_count FROM  employee_</span>tbl GROUP BY name WITH ROLLUP;</span><br><span class="line"><span class="code">+--------+</span>--------------+</span><br><span class="line">| name   | signin<span class="emphasis">_count |</span></span><br><span class="line"><span class="emphasis">+--------+--------------+</span></span><br><span class="line"><span class="emphasis">| 小丽 |            2 |</span></span><br><span class="line"><span class="emphasis">| 小明 |            7 |</span></span><br><span class="line"><span class="emphasis">| 小王 |            7 |</span></span><br><span class="line"><span class="emphasis">| NULL   |           16 |</span></span><br><span class="line"><span class="emphasis">+--------+--------------+</span></span><br><span class="line"><span class="emphasis">4 rows in set (0.00 sec)</span></span><br></pre></td></tr></table></figure>

<p>其中记录 NULL 表示所有人的登录次数。</p>
<p>我们可以使用 coalesce 来设置一个可以取代 NULL 的名称，coalesce 语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">coalesce</span>(a,b,c);</span><br></pre></td></tr></table></figure>

<p>参数说明：如果<code>a==null,则选择b；如果b==null,则选择c；如果a!=null,则选择a；如果a b c 都为null ，则返回为null（没意义）。</code></p>
<p>以下实例中如果名字为空我们使用总数代替：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT coalesce(name, &apos;总数&apos;), SUM(signin) as signin_count FROM  employee_tbl GROUP BY name WITH ROLLUP;</span><br><span class="line">+--------------------------+--------------+</span><br><span class="line">| coalesce(name, &apos;总数&apos;) | signin_count |</span><br><span class="line">+--------------------------+--------------+</span><br><span class="line">| 小丽                   |            2 |</span><br><span class="line">| 小明                   |            7 |</span><br><span class="line">| 小王                   |            7 |</span><br><span class="line">| 总数                   |           16 |</span><br><span class="line">+--------------------------+--------------+</span><br><span class="line">4 rows in set (0.01 sec)</span><br></pre></td></tr></table></figure>

<p>group by能用于多列去重</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> solution_id,s.problem_id,user_id,user_name,score <span class="keyword">FROM</span> solution s,contest_problem cp</span><br><span class="line"> <span class="keyword">where</span> s.contest_id = <span class="number">19</span> <span class="keyword">AND</span> s.problem_id = cp.problem_id </span><br><span class="line"><span class="keyword">AND</span> s.contest_id = cp.contest_id <span class="keyword">AND</span> <span class="keyword">result</span> = <span class="number">0</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> s.problem_id,user_id</span><br></pre></td></tr></table></figure>

<p>参考链接：<a href="https://www.runoob.com/mysql/mysql-group-by-statement.html" target="_blank" rel="noopener">菜鸟教程—MySQL GROUP BY 语句</a></p>
<h2 id="连接查询"><a href="#连接查询" class="headerlink" title="连接查询"></a>连接查询</h2><p>连接用于连接多个表，<strong>使用 JOIN 关键字</strong>，并且<strong>条件语句使用 ON</strong> 而不是 WHERE。</p>
<p><strong>连接可以替换子查询</strong>，并且比子查询的<strong>效率一般会更快。</strong></p>
<p>可以用 AS 给列名、计算字段和表名取别名，给表名取别名是为了简化 SQL 语句以及连接相同表。</p>
<blockquote>
<p>MySQL<strong>中的inner和outer可以省略</strong></p>
<p><strong>建议写上，可读性更好</strong></p>
<p>在MySQL中主要区分内连接和外链接的根本原因并不是这两个关键字 如果SQL语句中 带有left join或者 left outer join时 那这条SQL语句一定是外连接， 在写SQL语句时这两个关键字都可以省略 ，<strong>写上这两个关键字只是意味着可读性好</strong>（）</p>
</blockquote>
<p>语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 字段，...</span><br><span class="line"><span class="keyword">from</span> 表<span class="number">1</span></span><br><span class="line">【<span class="keyword">inner</span>|<span class="keyword">left</span> <span class="keyword">outer</span>|<span class="keyword">right</span> <span class="keyword">outer</span>|<span class="keyword">cross</span>】<span class="keyword">join</span> 表<span class="number">2</span> <span class="keyword">on</span>  连接条件</span><br><span class="line">【<span class="keyword">inner</span>|<span class="keyword">left</span> <span class="keyword">outer</span>|<span class="keyword">right</span> <span class="keyword">outer</span>|<span class="keyword">cross</span>】<span class="keyword">join</span> 表<span class="number">3</span> <span class="keyword">on</span>  连接条件</span><br><span class="line">【<span class="keyword">where</span> 筛选条件】</span><br><span class="line">【<span class="keyword">group</span> <span class="keyword">by</span> 分组字段】</span><br><span class="line">【<span class="keyword">having</span> 分组后的筛选条件】</span><br><span class="line">【<span class="keyword">order</span> <span class="keyword">by</span> 排序的字段或表达式】</span><br></pre></td></tr></table></figure>

<h3 id="内连接"><a href="#内连接" class="headerlink" title="内连接"></a>内连接</h3><p><strong>内连接又称等值连接</strong>，使用 INNER JOIN 关键字。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> A.value, B.value</span><br><span class="line"><span class="keyword">FROM</span> tablea <span class="keyword">AS</span> A <span class="keyword">INNER</span> <span class="keyword">JOIN</span> tableb <span class="keyword">AS</span> B</span><br><span class="line"><span class="keyword">ON</span> A.key = B.key;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>尽量使用INNER JOIN</strong>，好处：语句上，连接条件和筛选条件实现了分离，简洁明了！</p>
</blockquote>
<p>可以不明确使用 INNER JOIN，而使用<strong>普通查询并在 WHERE 中将两个表中要连接的列用等值方法连接起来。</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> A.value, B.value</span><br><span class="line"><span class="keyword">FROM</span> tablea <span class="keyword">AS</span> A, tableb <span class="keyword">AS</span> B</span><br><span class="line"><span class="keyword">WHERE</span> A.key = B.key;</span><br></pre></td></tr></table></figure>

<p><strong>在没有条件语句</strong>的情况下<strong>返回笛卡尔积</strong>。</p>
<p>扩展：</p>
<p>Cross join：（很少用）</p>
<p><strong>cross join</strong>，交叉连接，实际上就是将两个表进行笛卡尔积运算，结果表的行数等于两表行数之积</p>
<h4 id="笛卡尔积"><a href="#笛卡尔积" class="headerlink" title="笛卡尔积"></a>笛卡尔积</h4><p>笛卡尔乘积是指在数学中，两个<a href="https://baike.baidu.com/item/集合" target="_blank" rel="noopener">集合</a><em>X</em>和<em>Y</em>的笛卡尔积（Cartesian product），又称<a href="https://baike.baidu.com/item/直积" target="_blank" rel="noopener">直积</a>，表示为<em>X</em>×<em>Y</em>，第一个对象是<em>X</em>的成员而第二个对象是<em>Y</em>的所有可能<a href="https://baike.baidu.com/item/有序对" target="_blank" rel="noopener">有序对</a>的其中一个成员 [3] 。</p>
<p>假设集合A={a, b}，集合B={0, 1, 2}，则两个集合的笛卡尔积为{(a, 0), (a, 1), (a, 2), (b, 0), (b, 1), (b, 2)}。</p>
<p>类似的例子有，如果A表示某学校学生的集合，B表示该学校所有课程的集合，则A与B的笛卡尔积表示所有可能的选课情况。A表示所有声母的集合，B表示所有韵母的集合，那么A和B的笛卡尔积就为所有可能的汉字全拼。</p>
<p><strong>设A,B为集合，用A中元素为第一元素，B中元素为第二元素构成有序对，所有这样的有序对组成的集合叫做A与B的笛卡尔积，记作AxB.</strong></p>
<p>笛卡尔积的符号化为：</p>
<p>A×B={(x,y)|x∈A∧y∈B}</p>
<p>例如，A={a,b}, B={0,1,2}，则</p>
<p>A×B={(a, 0), (a, 1), (a, 2), (b, 0), (b, 1), (b, 2)}</p>
<p>B×A={(0, a), (0, b), (1, a), (1, b), (2, a), (2, b)}</p>
<img src="//codeofli.github.io/2019/03/数据库/mysql/mysql/2934349b033b5bb57f0eb50b36d3d539b700bc6e.jpg" style="zoom:50%;">

<h3 id="¶-自连接"><a href="#¶-自连接" class="headerlink" title="¶ 自连接"></a><a href="#自连接">¶</a> 自连接</h3><p><strong>自连接可以看成内连接的一种</strong>，只是<strong>连接的表是自身而已。</strong></p>
<p>一张员工表，包含员工姓名和员工所属部门，要找出与 Jim 处在同一部门的所有员工姓名。</p>
<p>子查询版本</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">name</span></span><br><span class="line"><span class="keyword">FROM</span> employee</span><br><span class="line"><span class="keyword">WHERE</span> department = (</span><br><span class="line">      <span class="keyword">SELECT</span> department</span><br><span class="line">      <span class="keyword">FROM</span> employee</span><br><span class="line">      <span class="keyword">WHERE</span> <span class="keyword">name</span> = <span class="string">"Jim"</span>);</span><br></pre></td></tr></table></figure>

<p>自连接版本</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> e1.name</span><br><span class="line"><span class="keyword">FROM</span> employee <span class="keyword">AS</span> e1 <span class="keyword">INNER</span> <span class="keyword">JOIN</span> employee <span class="keyword">AS</span> e2</span><br><span class="line"><span class="keyword">ON</span> e1.department = e2.department</span><br><span class="line">      <span class="keyword">AND</span> e2.name = <span class="string">"Jim"</span>;</span><br></pre></td></tr></table></figure>

<h3 id="¶-自然连接"><a href="#¶-自然连接" class="headerlink" title="¶ 自然连接"></a><a href="#自然连接">¶</a> 自然连接</h3><p>自然连接是把<strong>同名列通过等值测试连接起来的</strong>，同名列可以有多个。</p>
<p><strong>内连接和自然连接的区别</strong>: 内连接提供连接的列，而自然连接<strong>自动连接==所有同名列==。</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> A.value, B.value</span><br><span class="line"><span class="keyword">FROM</span> tablea <span class="keyword">AS</span> A <span class="keyword">NATURAL</span> <span class="keyword">JOIN</span> tableb <span class="keyword">AS</span> B;</span><br></pre></td></tr></table></figure>

<h3 id="¶-外连接"><a href="#¶-外连接" class="headerlink" title="¶ 外连接"></a><a href="#外连接">¶</a> 外连接</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LEFT|RIGHT OUTER JOIN</span><br></pre></td></tr></table></figure>

<p>外连接保留了<strong>没有关联的那些行</strong>。分为<strong>左外连接，右外连接以及全外连接</strong>，左外连接就是<strong>保留左表没有关联的行，右表选择列置为null</strong>。</p>
<p>检索所有顾客的订单信息，包括还没有订单信息的顾客。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Customers.cust_id, Orders.order_num</span><br><span class="line"><span class="keyword">FROM</span> Customers <span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> Orders</span><br><span class="line"><span class="keyword">ON</span> Customers.cust_id = Orders.cust_id;</span><br></pre></td></tr></table></figure>

<p>customers 表:</p>
<table>
<thead>
<tr>
<th align="center">cust_id</th>
<th align="center">cust_name</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="center">a</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">b</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">c</td>
</tr>
</tbody></table>
<p>orders 表:</p>
<table>
<thead>
<tr>
<th align="center">order_id</th>
<th align="center">cust_id</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="center">1</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">1</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">3</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">3</td>
</tr>
</tbody></table>
<p>结果:</p>
<table>
<thead>
<tr>
<th align="center">cust_id</th>
<th align="center">cust_name</th>
<th align="center">order_id</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="center">a</td>
<td align="center">1</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center">a</td>
<td align="center">2</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">c</td>
<td align="center">3</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">c</td>
<td align="center">4</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">b</td>
<td align="center">Null</td>
</tr>
</tbody></table>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p><img src="https://pic.leetcode-cn.com/ad3df1c4ecc7d2dbe85f92cdde8ec9a731fdd20dc4c5629ecb372b21de26c682-1.jpg" alt="1.jpg"></p>
<h2 id="子查询"><a href="#子查询" class="headerlink" title="子查询"></a>子查询</h2><p>子查询中只能返回一个字段的数据。</p>
<p>可以将子查询的结果作为 WHRER 语句的过滤条件:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> mytable1</span><br><span class="line"><span class="keyword">WHERE</span> col1 <span class="keyword">IN</span> (<span class="keyword">SELECT</span> col2</span><br><span class="line">               <span class="keyword">FROM</span> mytable2);</span><br></pre></td></tr></table></figure>

<p>下面的语句可以检索出客户的订单数量，子<strong>查询语句会对第一个查询检索出的每个客户执行一次</strong>:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cust_name, (<span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(*)</span><br><span class="line">                   <span class="keyword">FROM</span> Orders</span><br><span class="line">                   <span class="keyword">WHERE</span> Orders.cust_id = Customers.cust_id)</span><br><span class="line">                   <span class="keyword">AS</span> orders_num</span><br><span class="line"><span class="keyword">FROM</span> Customers</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> cust_name;</span><br></pre></td></tr></table></figure>

<h3 id="含义："><a href="#含义：" class="headerlink" title="含义："></a>含义：</h3><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">一条查询语句中又嵌套了另一条完整的<span class="keyword">select</span>语句，其中被嵌套的<span class="keyword">select</span>语句，称为子查询或内查询</span><br><span class="line">在外面的查询语句，称为主查询或外查询</span><br></pre></td></tr></table></figure>

<p>特点：</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>、子查询都放在小括号内</span><br><span class="line"><span class="number">2</span>、子查询可以放在<span class="keyword">from</span>后面、<span class="keyword">select</span>后面、<span class="keyword">where</span>后面、<span class="keyword">having</span>后面，但一般放在条件的右侧</span><br><span class="line"><span class="number">3</span>、子查询优先于主查询执行，主查询使用了子查询的执行结果</span><br><span class="line"><span class="number">4</span>、子查询根据查询结果的行数不同分为以下两类：</span><br><span class="line">① 单行子查询</span><br><span class="line">	结果集只有一行</span><br><span class="line">	一般搭配单行操作符使用：&gt; &lt; = &lt;&gt; &gt;= &lt;= </span><br><span class="line">	非法使用子查询的情况：</span><br><span class="line">	a、子查询的结果为一组值</span><br><span class="line">	b、子查询的结果为空</span><br><span class="line">	</span><br><span class="line">② 多行子查询</span><br><span class="line">	结果集有多行</span><br><span class="line">	一般搭配多行操作符使用：<span class="keyword">any</span>、<span class="keyword">all</span>、<span class="keyword">in</span>、<span class="keyword">not</span> <span class="keyword">in</span></span><br><span class="line">	<span class="keyword">in</span>： 属于子查询结果中的任意一个就行</span><br><span class="line">	<span class="keyword">any</span>和<span class="keyword">all</span>往往可以用其他查询代替</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT solution_id,problem_id,user_id,MIN(runtime) as runtime FROM solution</span><br><span class="line">        WHERE contest_id = 19 AND result = 0 GROUP BY problem_id,user_id</span><br></pre></td></tr></table></figure>

<h2 id="分页查询"><a href="#分页查询" class="headerlink" title="分页查询"></a>分页查询</h2><h3 id="¶-LIMIT"><a href="#¶-LIMIT" class="headerlink" title="¶ LIMIT"></a><a href="#limit">¶</a> LIMIT</h3><p><strong>限制返回的行数</strong>。可以有两个参数，第一个参数为<strong>起始行</strong>，<strong>从 0 开始</strong>；第二个参数为返回的总行数。</p>
<p>应用场景：</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">实际的web项目中需要根据用户的需求提交对应的分页查询的<span class="keyword">sql</span>语句</span><br></pre></td></tr></table></figure>

<p>语法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">select 字段|表达式,...</span><br><span class="line">from 表</span><br><span class="line">【where 条件】</span><br><span class="line">【group by 分组字段】</span><br><span class="line">【having 条件】</span><br><span class="line">【order by 排序的字段】</span><br><span class="line">limit 【起始行，】条目数;</span><br><span class="line"># 使用offset</span><br><span class="line">select 字段|表达式,...</span><br><span class="line">from 表</span><br><span class="line">【where 条件】</span><br><span class="line">【group by 分组字段】</span><br><span class="line">【having 条件】</span><br><span class="line">【order by 排序的字段】</span><br><span class="line">limit 条目数 offset 起始行;</span><br></pre></td></tr></table></figure>

<p>特点：</p>
<ol>
<li><p>起始条目索引从0开始</p>
</li>
<li><p>limit子句放在查询语句的最后</p>
</li>
<li><p>公式：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span>  表 <span class="keyword">limit</span> （page<span class="number">-1</span>）*sizePerPage,sizePerPage</span><br></pre></td></tr></table></figure>


</li>
</ol>
<p>   假如:<br>   每页显示条目数sizePerPage<br>   要显示的页数 page</p>
<p>返回前 5 行:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> mytable</span><br><span class="line"><span class="keyword">LIMIT</span> <span class="number">5</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> mytable</span><br><span class="line"><span class="keyword">LIMIT</span> <span class="number">0</span>, <span class="number">5</span>;</span><br></pre></td></tr></table></figure>

<p>返回第 3 ~ 5 行:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> mytable</span><br><span class="line"><span class="keyword">LIMIT</span> <span class="number">2</span>, <span class="number">3</span>;</span><br></pre></td></tr></table></figure>

<h3 id="offset"><a href="#offset" class="headerlink" title="offset"></a>offset</h3><p>当 <strong>limit和offset组合使用的时候</strong>，limit后面只能有一个参数，表示要取的的数量,offset表示要跳过的数量 。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select * from article </span><br><span class="line">LIMIT 3 OFFSET 1</span><br></pre></td></tr></table></figure>

<p> 表示跳过1条数据,从第2条数据开始取，取3条数据，也就是取2,3,4三条数据</p>
<h2 id="联合查询，组合查询"><a href="#联合查询，组合查询" class="headerlink" title="联合查询，组合查询"></a>联合查询，组合查询</h2><p>使用  <strong>UNION</strong>  来组合两个查询，如果第一个查询返回 M 行，第二个查询返回 N 行，那么<strong>组合查询的结果一般为 M+N 行</strong>。</p>
<p>每个查询必须<strong>包含相同的列、表达式和聚集函数。</strong></p>
<p><strong>默认会去除相同行</strong>，如果<strong>需要保留相同行，使用 UNION ALL。</strong></p>
<p>只能包含一个 ORDER BY 子句，并且必须位于语句的最后。</p>
<p>语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 字段|常量|表达式|函数 【<span class="keyword">from</span> 表】 【<span class="keyword">where</span> 条件】 <span class="keyword">union</span> 【<span class="keyword">all</span>】</span><br><span class="line"><span class="keyword">select</span> 字段|常量|表达式|函数 【<span class="keyword">from</span> 表】 【<span class="keyword">where</span> 条件】 <span class="keyword">union</span> 【<span class="keyword">all</span>】</span><br><span class="line">.....</span><br><span class="line"><span class="keyword">select</span> 字段|常量|表达式|函数 【<span class="keyword">from</span> 表】 【<span class="keyword">where</span> 条件】</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">col</span></span><br><span class="line"><span class="keyword">FROM</span> mytable</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">col</span> = <span class="number">1</span></span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">col</span></span><br><span class="line"><span class="keyword">FROM</span> mytable</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">col</span> =<span class="number">2</span>;</span><br></pre></td></tr></table></figure>

<h1 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h1><p><strong>视图是虚拟的表</strong>，本身不包含数据，也就不能对其进行索引操作。</p>
<p>对视图的操作<strong>和对普通表的操作一样</strong>。</p>
<p>视图具有如下好处:</p>
<ul>
<li>简化复杂的 SQL 操作，比如复杂的连接；</li>
<li>只使用实际表的一部分数据；</li>
<li>通过<strong>只给用户访问视图的权限，保证数据的安全性</strong>；</li>
<li>更改数据格式和表示。</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> myview <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">Concat</span>(col1, col2) <span class="keyword">AS</span> concat_col, col3*col4 <span class="keyword">AS</span> compute_col</span><br><span class="line"><span class="keyword">FROM</span> mytable</span><br><span class="line"><span class="keyword">WHERE</span> col5 = val;</span><br></pre></td></tr></table></figure>

<h3 id="视图的创建"><a href="#视图的创建" class="headerlink" title="视图的创建"></a>视图的创建</h3><p>​    语法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">CREATE VIEW  视图名</span><br><span class="line">AS</span><br><span class="line">查询语句;</span><br></pre></td></tr></table></figure>

<h3 id="视图的增删改查"><a href="#视图的增删改查" class="headerlink" title="视图的增删改查"></a>视图的增删改查</h3><p>​    1、查看视图的数据 ★</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> my_v4;</span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> my_v1 <span class="keyword">WHERE</span> last_name=<span class="string">'Partners'</span>;</span><br><span class="line"></span><br><span class="line">2、插入视图的数据</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> my_v4(last_name,department_id) <span class="keyword">VALUES</span>(<span class="string">'虚竹'</span>,<span class="number">90</span>);</span><br><span class="line"></span><br><span class="line">3、修改视图的数据</span><br><span class="line"></span><br><span class="line"><span class="keyword">UPDATE</span> my_v4 <span class="keyword">SET</span> last_name =<span class="string">'梦姑'</span> <span class="keyword">WHERE</span> last_name=<span class="string">'虚竹'</span>;</span><br></pre></td></tr></table></figure>

<pre><code>4、删除视图的数据
DELETE FROM my_v4;</code></pre><h3 id="某些视图不能更新"><a href="#某些视图不能更新" class="headerlink" title="某些视图不能更新"></a>某些视图不能更新</h3><p>​    包含以下关键字的sql语句：分组函数、distinct、group  by、having、union或者union all<br>​    常量视图<br>​    Select中包含子查询<br>​    join<br>​    from一个不能更新的视图<br>​    where子句的子查询引用了from子句中的表</p>
<h3 id="视图逻辑的更新"><a href="#视图逻辑的更新" class="headerlink" title="视图逻辑的更新"></a>视图逻辑的更新</h3><p>​    #方式一：<br>​    CREATE OR REPLACE VIEW test_v7<br>​    AS<br>​    SELECT last_name FROM employees<br>​    WHERE employee_id&gt;100;<br>​    </p>
<pre><code>#方式二:
ALTER VIEW test_v7
AS
SELECT employee_id FROM employees;

SELECT * FROM test_v7;</code></pre><h3 id="视图的删除"><a href="#视图的删除" class="headerlink" title="视图的删除"></a>视图的删除</h3><p>​    DROP VIEW test_v1,test_v2,test_v3;</p>
<h3 id="视图结构的查看"><a href="#视图结构的查看" class="headerlink" title="视图结构的查看"></a>视图结构的查看</h3><p>​    DESC test_v7;<br>​    SHOW CREATE VIEW test_v7;</p>
<p>著作权归<a href="https://pdai.tech所有。" target="_blank" rel="noopener">https://pdai.tech所有。</a> 链接：<a href="https://pdai.tech/md/db/sql-lan/sql-lan.html" target="_blank" rel="noopener">https://pdai.tech/md/db/sql-lan/sql-lan.html</a></p>
<h1 id="存储过程"><a href="#存储过程" class="headerlink" title="存储过程"></a>存储过程</h1><p>存储<strong>过程</strong>可以看成是<strong>对一系列 SQL 操作的批处理。</strong></p>
<p>使用存储过程的好处:</p>
<ul>
<li>代码封装，保证了一定的安全性；</li>
<li>代码复用；</li>
<li>由于是<strong>预先编译，因此具有很高的性能。</strong></li>
</ul>
<p>命令行中创建存储过程需要自定义分隔符，因为命令行是以 ; 为结束符，而存储过程中也包含了分号，因此会错误把这部分分号当成是结束符，造成语法错误。</p>
<p><strong>包含 in、out 和 inout 三种参数。</strong></p>
<p>给<strong>变量赋值都需要用 select into 语句。</strong></p>
<p>每次<strong>只能给一个变量赋值，不支持集合的操作。</strong></p>
<h2 id="创建存储过程"><a href="#创建存储过程" class="headerlink" title="创建存储过程"></a>创建存储过程</h2><p>语法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">create procedure 存储过程名(in|out|inout 参数名  参数类型,...)</span><br><span class="line">begin</span><br><span class="line">	存储过程体</span><br><span class="line"></span><br><span class="line">end</span><br></pre></td></tr></table></figure>

<p>类似于方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">修饰符 返回类型 方法名(参数类型 参数名,...)&#123;</span><br><span class="line"></span><br><span class="line">	方法体;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>参数类型：参数前面的符号的意思<br>in:该参数<strong>只能作为输入</strong> （该参数不能做返回值）<br>out：该参数<strong>只能作为输出</strong>（该参数只能做返回值）<br>inout：<strong>既能做输入又能做输出</strong></p>
<blockquote>
<p>注意：in、out、inout都可以在<strong>一个存储过程中带多个</strong></p>
</blockquote>
<h3 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h3><p>1、需要设置新的结束标记</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">delimiter 新的结束标记</span><br></pre></td></tr></table></figure>

<p>示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">delimiter $</span><br><span class="line"></span><br><span class="line">CREATE PROCEDURE 存储过程名(IN|OUT|INOUT 参数名  参数类型,...)</span><br><span class="line">BEGIN</span><br><span class="line">	sql语句1;</span><br><span class="line">	sql语句2;</span><br><span class="line"></span><br><span class="line">END $</span><br></pre></td></tr></table></figure>

<p>2、存储过程体中可以有多条sql语句，如果仅仅一条sql语句，则可以省略begin end</p>
<h2 id="调用存储过程"><a href="#调用存储过程" class="headerlink" title="调用存储过程"></a>调用存储过程</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">call 存储过程名(实参列表)</span><br></pre></td></tr></table></figure>

<h2 id="用例"><a href="#用例" class="headerlink" title="用例"></a>用例</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">delimiter //</span><br><span class="line"></span><br><span class="line">create procedure myprocedure( out ret int )</span><br><span class="line">    begin</span><br><span class="line">        declare y int;</span><br><span class="line">        select sum(col1)</span><br><span class="line">        from mytable</span><br><span class="line">        into y;</span><br><span class="line">        select y*y into ret;</span><br><span class="line">    end //</span><br><span class="line"></span><br><span class="line">delimiter ;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">call myprocedure(@ret);</span><br><span class="line">select @ret;</span><br></pre></td></tr></table></figure>

<p>著作权归<a href="https://pdai.tech所有。" target="_blank" rel="noopener">https://pdai.tech所有。</a> 链接：<a href="https://pdai.tech/md/db/sql-lan/sql-lan.html" target="_blank" rel="noopener">https://pdai.tech/md/db/sql-lan/sql-lan.html</a></p>
<h1 id="游标"><a href="#游标" class="headerlink" title="游标"></a>游标</h1><p>在存储过程中使用游标可以<strong>对一个结果集进行移动遍历。</strong></p>
<p>游标主要用于交互式应用，其中用户需要对数据集中的任意行进行浏览和修改。</p>
<p>使用游标的四个步骤:</p>
<ol>
<li>声明游标，这个过程没有实际检索出数据；</li>
<li>打开游标；</li>
<li>取出数据；</li>
<li>关闭游标；</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">delimiter //</span><br><span class="line">create procedure myprocedure(out ret int)</span><br><span class="line">    begin</span><br><span class="line">        declare done boolean default 0;</span><br><span class="line"></span><br><span class="line">        declare mycursor cursor for</span><br><span class="line">        select col1 from mytable;</span><br><span class="line">        # 定义了一个 continue handler，当 sqlstate &apos;02000&apos; 这个条件出现时，会执行 set done = 1</span><br><span class="line">        declare continue handler for sqlstate &apos;02000&apos; set done = 1;</span><br><span class="line"></span><br><span class="line">        open mycursor;</span><br><span class="line"></span><br><span class="line">        repeat</span><br><span class="line">            fetch mycursor into ret;</span><br><span class="line">            select ret;</span><br><span class="line">        until done end repeat;</span><br><span class="line"></span><br><span class="line">        close mycursor;</span><br><span class="line">    end //</span><br><span class="line"> delimiter ;</span><br></pre></td></tr></table></figure>

<p>著作权归<a href="https://pdai.tech所有。" target="_blank" rel="noopener">https://pdai.tech所有。</a> 链接：<a href="https://pdai.tech/md/db/sql-lan/sql-lan.html" target="_blank" rel="noopener">https://pdai.tech/md/db/sql-lan/sql-lan.html</a></p>
<h1 id="触发器"><a href="#触发器" class="headerlink" title="触发器"></a>触发器</h1><p>触发器会在某个表执行以下语句（修改语句）时而自动执行: DELETE、INSERT、UPDATE。</p>
<p>触发器必须指定在语句<strong>执行之前还是之后</strong>自动执行，之前执行使用 BEFORE 关键字，之后执行使用 AFTER 关键字。BEFORE 用于<strong>数据验证和净化</strong>，AFTER 用于<strong>审计跟踪</strong>，将修改记录到另外一张表中。</p>
<p>INSERT 触发器包含一个名为 <strong>NEW 的虚拟表</strong>。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> mytrigger <span class="keyword">AFTER</span> <span class="keyword">INSERT</span> <span class="keyword">ON</span> mytable</span><br><span class="line"><span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="keyword">ROW</span> <span class="keyword">SELECT</span> NEW.col <span class="keyword">into</span> @<span class="keyword">result</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> @<span class="keyword">result</span>; <span class="comment">-- 获取结果</span></span><br></pre></td></tr></table></figure>

<p>DELETE 触发器包含一个名为 <strong>OLD 的虚拟表</strong>，并且是只读的。</p>
<p>UPDATE 触发器包含<strong>一个名为 NEW 和一个名为 OLD 的虚拟表</strong>，其中 <strong>NEW 是可以被修改的</strong>，而 OLD 是只读的。</p>
<p>MySQL 不允许在触发器中使用 CALL 语句，也就是不能调用存储过程。</p>
<p>著作权归<a href="https://pdai.tech所有。" target="_blank" rel="noopener">https://pdai.tech所有。</a> 链接：<a href="https://pdai.tech/md/db/sql-lan/sql-lan.html" target="_blank" rel="noopener">https://pdai.tech/md/db/sql-lan/sql-lan.html</a></p>
<h1 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h1><h3 id="创建函数"><a href="#创建函数" class="headerlink" title="创建函数"></a>创建函数</h3><p>学过的函数：LENGTH、SUBSTR、CONCAT等<br>语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> 函数名(参数名 参数类型,...) <span class="keyword">RETURNS</span> 返回类型</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">	函数体</span><br><span class="line"></span><br><span class="line"><span class="keyword">END</span></span><br></pre></td></tr></table></figure>

<h3 id="调用函数"><a href="#调用函数" class="headerlink" title="调用函数"></a>调用函数</h3><p>​    SELECT 函数名（实参列表）</p>
<h3 id="函数和存储过程的区别"><a href="#函数和存储过程的区别" class="headerlink" title="函数和存储过程的区别"></a>函数和存储过程的区别</h3><figure class="highlight cal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">		关键字		调用语法	返回值			应用场景</span><br><span class="line">函数		FUNCTION	SELECT 函数()	只能是一个		一般用于查询结果为一个值并返回时，当有返回值而且仅仅一个</span><br><span class="line">存储过程	<span class="function"><span class="keyword">PROCEDURE</span>	<span class="title">CALL</span> 存储过程<span class="params">()</span>	可以有0个或多个		一般用于更新</span></span><br></pre></td></tr></table></figure>

<h1 id="字符集"><a href="#字符集" class="headerlink" title="字符集"></a>字符集</h1><p>基本术语:</p>
<ul>
<li>字符集为字母和符号的集合；</li>
<li>编码为某个字符集成员的内部表示；</li>
<li>校对字符指定如何比较，主要用于排序和分组。</li>
</ul>
<p>除了给表指定字符集和校对外，也可以给列指定:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE mytable</span><br><span class="line">(col VARCHAR(10) CHARACTER SET latin COLLATE latin1_general_ci )</span><br><span class="line">DEFAULT CHARACTER SET hebrew COLLATE hebrew_general_ci;</span><br></pre></td></tr></table></figure>

<p>可以在排序、分组时指定校对:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> mytable</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">col</span> <span class="keyword">COLLATE</span> latin1_general_ci;</span><br></pre></td></tr></table></figure>

<h1 id="增删改，DML语言"><a href="#增删改，DML语言" class="headerlink" title="增删改，DML语言"></a>增删改，DML语言</h1><p>DML（Data Manipulation Language），数据操纵语言，即增删改，INSERT、UPDATE、DELETE。</p>
<p>数据操纵语言DML主要有三种形式：</p>
<p>1) 插入：INSERT<br>2) 更新：UPDATE<br>3) 删除：DELETE</p>
<h2 id="插入"><a href="#插入" class="headerlink" title="插入"></a>插入</h2><p>语法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">insert into 表名(字段名，...)</span><br><span class="line">values(值1，...);</span><br><span class="line">INSERT INTO mytable(col1, col2)</span><br><span class="line">VALUES(val1, val2);</span><br></pre></td></tr></table></figure>

<p>特点：</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>、字段类型和值类型一致或兼容，而且一一对应</span><br><span class="line"><span class="number">2</span>、可以为空的字段，可以不用插入值，或用<span class="literal">null</span>填充</span><br><span class="line"><span class="number">3</span>、不可以为空的字段，必须插入值</span><br><span class="line"><span class="number">4</span>、字段个数和值的个数必须一致</span><br><span class="line"><span class="number">5</span>、字段可以省略，但默认所有字段，并且顺序和表中的存储顺序一致</span><br></pre></td></tr></table></figure>

<p>插入检索出来的数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> mytable1(col1, col2)</span><br><span class="line"><span class="keyword">SELECT</span> col1, col2</span><br><span class="line"><span class="keyword">FROM</span> mytable2;</span><br></pre></td></tr></table></figure>

<p>将一个表的内容插入到一个新表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> newtable <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> mytable;</span><br></pre></td></tr></table></figure>

<h2 id="修改（更新）"><a href="#修改（更新）" class="headerlink" title="修改（更新）"></a>修改（更新）</h2><p>修改单表语法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">update 表名 set 字段=新值,字段=新值</span><br><span class="line">【where 条件】</span><br><span class="line">UPDATE mytable</span><br><span class="line">SET col = val</span><br><span class="line">WHERE id = 1;</span><br></pre></td></tr></table></figure>

<p>修改多表语法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">update 表1 别名1,表2 别名2</span><br><span class="line">set 字段=新值，字段=新值</span><br><span class="line">where 连接条件</span><br><span class="line">and 筛选条件</span><br></pre></td></tr></table></figure>

<h2 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h2><p>方式1：delete语句 </p>
<p>单表的删除： ★</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">delete from 表名</span><br><span class="line">【where 筛选条件】</span><br><span class="line">DELETE FROM mytable</span><br><span class="line">WHERE id = 1;</span><br></pre></td></tr></table></figure>

<p>多表的删除：</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">delete 别名<span class="number">1</span>，别名<span class="number">2</span></span><br><span class="line"><span class="keyword">from</span> 表<span class="number">1</span> 别名<span class="number">1</span>，表<span class="number">2</span> 别名<span class="number">2</span></span><br><span class="line">where 连接条件</span><br><span class="line"><span class="keyword">and</span> 筛选条件;</span><br></pre></td></tr></table></figure>

<p>方式2：truncate语句</p>
<p><strong>TRUNCATE TABLE</strong> 可以清空表，也就是删除所有行。</p>
<blockquote>
<p>truncate v. 截断,截取</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">truncate table 表名</span><br><span class="line">TRUNCATE TABLE mytable;</span><br></pre></td></tr></table></figure>

<p>两种方式的区别【面试题】删除</p>
<p>使用更新和删除操作时一定要用 WHERE 子句，不然会把整张表的数据都破坏。可以先用 SELECT 语句进行测试，防止错误删除。    </p>
<p>1.truncate不能加where条件，而delete可以加where条件</p>
<p>2.truncate的效率高一丢丢</p>
<p>3.truncate 删除带自增长的列的表后，如果再插入数据，数据从1开始<br>#delete 删除带自增长列的表后，如果再插入数据，数据从上一次的断点处开始</p>
<p>4.truncate删除不能回滚，delete删除可以回滚</p>
<h1 id="定义-DDL语句，"><a href="#定义-DDL语句，" class="headerlink" title="定义-DDL语句，"></a>定义-DDL语句，</h1><p>DDL（data definition language）：数据库模式定义语言</p>
<p>数据定义语言，DDL用来<strong>创建数据库中的各种对象–</strong>—表、视图、索引、同义词、聚簇等如：CREATE TABLE / VIEW / INDEX / SYN / CLUSTER| 表 视图 索引 同义词 簇。DDL操作是隐性提交的！不能rollback。</p>
<p>DDL主要是用在<strong>定义或改变</strong>表（TABLE）的结构，数据类型，表之间的链接和约束等初始化工作上，他们大多在建立表时使用</p>
<h2 id="数据库、表的操作-命令"><a href="#数据库、表的操作-命令" class="headerlink" title="数据库、表的操作(命令)"></a>数据库、表的操作(命令)</h2><p>创建数据库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE DATABASE IF NOT EXISTS yoj DEFAULT CHARSET utf8 COLLATE utf8_general_ci;</span><br></pre></td></tr></table></figure>

<p>创建数据库，该命令的作用：</p>
<ul>
<li><p>\1. 如果数据库不存在则创建，存在则不创建。</p>
</li>
<li><p>\2. 创建yoj数据库，并设定编码集为utf8</p>
</li>
</ul>
<p>删除数据库。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">DATABASE</span> dbName;</span><br></pre></td></tr></table></figure>

<p>创建数据库。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">database</span> yoj;</span><br></pre></td></tr></table></figure>

<p>  1.查看当前所有的数据库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show databases;</span><br></pre></td></tr></table></figure>

<p>2.打开(使用)指定的库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">use 库名</span><br></pre></td></tr></table></figure>

<p>3.查看当前库的所有表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show tables;</span><br></pre></td></tr></table></figure>

<p>4.查看其它库的所有表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show tables from 库名;</span><br></pre></td></tr></table></figure>

<p>5.创建表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">create table 表名(</span><br><span class="line"></span><br><span class="line">	列名 列类型,</span><br><span class="line">	列名 列类型，</span><br><span class="line">	。。。</span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">CREATE TABLE mytable (</span><br><span class="line">  id INT NOT NULL AUTO_INCREMENT,</span><br><span class="line">  col1 INT NOT NULL DEFAULT 1,</span><br><span class="line">  col2 VARCHAR(45) NULL,</span><br><span class="line">  col3 DATE NULL,</span><br><span class="line">  PRIMARY KEY (`id`)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>6.查看表结构</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">desc 表名;</span><br></pre></td></tr></table></figure>

<h2 id="修改表结构"><a href="#修改表结构" class="headerlink" title="修改表结构"></a>修改表结构</h2><p>添加列</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> mytable</span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">col</span> <span class="built_in">CHAR</span>(<span class="number">20</span>);</span><br></pre></td></tr></table></figure>

<p>删除列</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> mytable</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">COLUMN</span> <span class="keyword">col</span>;</span><br></pre></td></tr></table></figure>

<p>删除表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> mytable;</span><br></pre></td></tr></table></figure>

<h3 id="修改字段类型和列级约束"><a href="#修改字段类型和列级约束" class="headerlink" title="修改字段类型和列级约束"></a>修改字段类型和列级约束</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE studentinfo MODIFY COLUMN borndate DATE ;</span><br></pre></td></tr></table></figure>

<h4 id="唯一约束（UNIQUE-KEY）"><a href="#唯一约束（UNIQUE-KEY）" class="headerlink" title="唯一约束（UNIQUE KEY）"></a>唯一约束（UNIQUE KEY）</h4><p>MySQL唯一约束（Unique Key）要求<strong>该列唯一，允许为空</strong>，但只能出现一个空值。唯一约束可以确保一列或者几列不出现重复值。</p>
<h5 id="在创建表时设置唯一约束"><a href="#在创建表时设置唯一约束" class="headerlink" title="在创建表时设置唯一约束"></a>在创建表时设置唯一约束</h5><p>在定义完列之后直接使用 UNIQUE 关键字指定唯一约束，语法规则如下：</p>
<p>&lt;字段名&gt; &lt;数据类型&gt; UNIQUE</p>
<p>【实例 1】创建数据表 tb_dept2，指定部门的名称唯一，输入的 SQL 语句和运行结果如下所示。</p>
<p>CREATE TABLE tb_dept2<br>(<br>     id INT(11) PRIMARY KEY,<br>     name VARCHAR(22) UNIQUE,<br>     location VARCHAR(50)<br>);</p>
<p>查询tb_dept2结构</p>
<p>mysql&gt; DESC tb_dept2;<br>+———-+————-+——+—–+———+——-+<br>| Field    | Type        | Null | Key | Default | Extra |<br>+———-+————-+——+—–+———+——-+<br>| id       | int(11)     | NO   | PRI | NULL    |       |<br>| name     | varchar(22) | YES  | UNI | NULL    |       |<br>| location | varchar(50) | YES  |     | NULL    |       |<br>+———-+————-+——+—–+———+——-+<br>3 rows in set (0.03 sec)</p>
<p>UNI 就是唯一约束</p>
<p>提示：UNIQUE 和 PRIMARY KEY 的区别：一个表可以有多个字段声明为 UNIQUE，但只能有一个 PRIMARY KEY 声明；声明为 PRIMAY KEY 的列不允许有空值，但是声明为 UNIQUE 的字段允许空值的存在。</p>
<p>因为是创建时候指定的所以他的唯一约束名称就是他本身</p>
<h5 id="在修改表时添加唯一约束"><a href="#在修改表时添加唯一约束" class="headerlink" title="在修改表时添加唯一约束"></a>在修改表时添加唯一约束</h5><p>在修改表时添加唯一约束的语法格式为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE &lt;数据表名&gt; ADD CONSTRAINT &lt;唯一约束名&gt; UNIQUE(&lt;列名&gt;);</span><br></pre></td></tr></table></figure>

<p>【实例 2】修改数据表 tb_dept1，指定部门的名称唯一，输入的 SQL 语句和运行结果如下所示。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE tb_dept1 ADD CONSTRAINT unique_name UNIQUE(name);</span><br></pre></td></tr></table></figure>

<p>查询tb_dept1结构</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;  DESC tb_dept1;</span><br><span class="line">+----------+-------------+------+-----+---------+-------+</span><br><span class="line">| Field    | Type        | Null | Key | Default | Extra |</span><br><span class="line">+----------+-------------+------+-----+---------+-------+</span><br><span class="line">| id       | int(11)     | NO   | PRI | NULL    |       |</span><br><span class="line">| name     | varchar(22) | NO   | UNI | NULL    |       |</span><br><span class="line">| location | varchar(50) | YES  |     | NULL    |       |</span><br><span class="line">+----------+-------------+------+-----+---------+-------+</span><br><span class="line">3 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.04 sec)</span><br></pre></td></tr></table></figure>

<p>删除唯一约束</p>
<p>在 MySQL 中删除唯一约束的语法格式如下：</p>
<p>ALTER TABLE &lt;表名&gt; DROP INDEX &lt;唯一约束名&gt;;<br>1<br>【实例 3】删除数据表 tb_dept1 中的唯一约束 unique_name，输入的 SQL 语句和运行结果如下所示。</p>
<p>ALTER TABLE tb_dept1<br>DROP INDEX unique_name;<br>1<br>2<br>查询tb_dept1结构</p>
<p>mysql&gt; DESC tb_dept1;<br>+———-+————-+——+—–+———+——-+<br>| Field    | Type        | Null | Key | Default | Extra |<br>+———-+————-+——+—–+———+——-+<br>| id       | int(11)     | NO   | PRI | NULL    |       |<br>| name     | varchar(22) | NO   |     | NULL    |       |<br>| location | varchar(50) | YES  |     | NULL    |       |<br>+———-+————-+——+—–+———+——-+<br>3 rows in set (0.03 sec)</p>
<p>可以发现name的key 没有UNI了</p>
<p>参考链接：<a href="https://blog.csdn.net/weixin_45203607/article/details/120248076" target="_blank" rel="noopener">https://blog.csdn.net/weixin_45203607/article/details/120248076</a></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">7.查看服务器的版本</span><br><span class="line">方式一：登录到mysql服务端</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">version</span>();</span><br><span class="line">方式二：没有登录到mysql服务端</span><br><span class="line">mysql <span class="comment">--version</span></span><br><span class="line">或</span><br><span class="line">mysql <span class="comment">--V</span></span><br></pre></td></tr></table></figure>

<h2 id="库和表的管理"><a href="#库和表的管理" class="headerlink" title="库和表的管理"></a>库和表的管理</h2><p>库的管理：</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">一、创建库</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">database</span> 库名</span><br><span class="line">二、删除库</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">database</span> 库名</span><br></pre></td></tr></table></figure>

<p>表的管理：</p>
<pre><code># 1.创建表</code></pre><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> stuinfo(</span><br><span class="line">	stuId <span class="type">INT</span>,</span><br><span class="line">	stuName <span class="type">VARCHAR</span>(<span class="number">20</span>),</span><br><span class="line">	gender <span class="type">CHAR</span>,</span><br><span class="line">	bornDate DATETIME</span><br></pre></td></tr></table></figure>

<pre><code>);

DESC studentinfo;</code></pre><h2 id="2-修改表-alter"><a href="#2-修改表-alter" class="headerlink" title="2.修改表 alter"></a>2.修改表 alter</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">语法：<span class="keyword">ALTER</span> <span class="keyword">TABLE</span> 表名 <span class="keyword">ADD</span>|<span class="keyword">MODIFY</span>|<span class="keyword">DROP</span>|<span class="keyword">CHANGE</span> <span class="keyword">COLUMN</span> 字段名 【字段类型】;</span><br><span class="line"></span><br><span class="line"><span class="comment">#①修改字段名</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> studentinfo <span class="keyword">CHANGE</span>  <span class="keyword">COLUMN</span> sex gender <span class="built_in">CHAR</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">#②修改表名</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> stuinfo <span class="keyword">RENAME</span> [<span class="keyword">TO</span>]  studentinfo;</span><br><span class="line"><span class="comment">#③修改字段类型和列级约束</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> studentinfo <span class="keyword">MODIFY</span> <span class="keyword">COLUMN</span> borndate <span class="built_in">DATE</span> ;</span><br><span class="line"></span><br><span class="line"><span class="comment">#④添加字段</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> studentinfo <span class="keyword">ADD</span> <span class="keyword">COLUMN</span> email <span class="built_in">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">first</span>;</span><br><span class="line"><span class="comment">#⑤删除字段</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> studentinfo <span class="keyword">DROP</span> <span class="keyword">COLUMN</span> email;</span><br></pre></td></tr></table></figure>

<p>​    # 3.删除表<br>​<br>​    DROP TABLE [IF EXISTS] studentinfo;</p>
<p>​    </p>
<h3 id="常见类型"><a href="#常见类型" class="headerlink" title="常见类型"></a>常见类型</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">整型：</span><br><span class="line">	</span><br><span class="line">小数：</span><br><span class="line">	浮点型</span><br><span class="line">	定点型</span><br><span class="line">字符型：</span><br><span class="line">日期型：</span><br><span class="line">Blob类型：</span><br></pre></td></tr></table></figure>

<h3 id="常见约束"><a href="#常见约束" class="headerlink" title="常见约束"></a>常见约束</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line">DEFAULT</span><br><span class="line">UNIQUE</span><br><span class="line">CHECK</span><br><span class="line">PRIMARY KEY</span><br><span class="line">FOREIGN KEY</span><br></pre></td></tr></table></figure>

<h2 id="流程控制结构"><a href="#流程控制结构" class="headerlink" title="流程控制结构"></a>流程控制结构</h2><h3 id="系统变量"><a href="#系统变量" class="headerlink" title="系统变量"></a>系统变量</h3><p>一、全局变量</p>
<p>作用域：针对于所有会话（连接）有效，但不能跨重启</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">查看所有全局变量</span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">GLOBAL</span> <span class="keyword">VARIABLES</span>;</span><br><span class="line">查看满足条件的部分系统变量</span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">GLOBAL</span> <span class="keyword">VARIABLES</span> <span class="keyword">LIKE</span> <span class="string">'%char%'</span>;</span><br><span class="line">查看指定的系统变量的值</span><br><span class="line"><span class="keyword">SELECT</span> @@global.autocommit;</span><br><span class="line">为某个系统变量赋值</span><br><span class="line"><span class="keyword">SET</span> @@global.autocommit=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">SET</span> <span class="keyword">GLOBAL</span> autocommit=<span class="number">0</span>;</span><br></pre></td></tr></table></figure>

<p>二、会话变量</p>
<p>作用域：针对于当前会话（连接）有效</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">查看所有会话变量</span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">SESSION</span> <span class="keyword">VARIABLES</span>;</span><br><span class="line">查看满足条件的部分会话变量</span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">SESSION</span> <span class="keyword">VARIABLES</span> <span class="keyword">LIKE</span> <span class="string">'%char%'</span>;</span><br><span class="line">查看指定的会话变量的值</span><br><span class="line"><span class="keyword">SELECT</span> @@autocommit;</span><br><span class="line"><span class="keyword">SELECT</span> @@session.tx_isolation;</span><br><span class="line">为某个会话变量赋值</span><br><span class="line"><span class="keyword">SET</span> @@session.tx_isolation=<span class="string">'read-uncommitted'</span>;</span><br><span class="line"><span class="keyword">SET</span> <span class="keyword">SESSION</span> tx_isolation=<span class="string">'read-committed'</span>;</span><br></pre></td></tr></table></figure>

<p>###自定义变量<br>一、用户变量</p>
<p>声明并初始化：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SET</span> @变量名=值;</span><br><span class="line"><span class="keyword">SET</span> @变量名:=值;</span><br><span class="line"><span class="keyword">SELECT</span> @变量名:=值;</span><br></pre></td></tr></table></figure>

<p>赋值：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">方式一：一般用于赋简单的值</span><br><span class="line"><span class="keyword">SET</span> 变量名=值;</span><br><span class="line"><span class="keyword">SET</span> 变量名:=值;</span><br><span class="line"><span class="keyword">SELECT</span> 变量名:=值;</span><br></pre></td></tr></table></figure>

<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">方式二：一般用于赋表 中的字段值</span><br><span class="line"><span class="keyword">SELECT</span> 字段名或表达式 <span class="keyword">INTO</span> 变量</span><br><span class="line"><span class="keyword">FROM</span> 表;</span><br></pre></td></tr></table></figure>

<p>使用：</p>
<figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> @变量名;</span><br></pre></td></tr></table></figure>

<p>二、局部变量</p>
<p>声明：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span> 变量名 类型 【<span class="keyword">default</span> 值】;</span><br></pre></td></tr></table></figure>

<p>赋值：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">方式一：一般用于赋简单的值</span><br><span class="line"><span class="keyword">SET</span> 变量名=值;</span><br><span class="line"><span class="keyword">SET</span> 变量名:=值;</span><br><span class="line"><span class="keyword">SELECT</span> 变量名:=值;</span><br></pre></td></tr></table></figure>

<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">方式二：一般用于赋表 中的字段值</span><br><span class="line"><span class="keyword">SELECT</span> 字段名或表达式 <span class="keyword">INTO</span> 变量</span><br><span class="line"><span class="keyword">FROM</span> 表;</span><br></pre></td></tr></table></figure>

<p>使用：</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 变量名</span><br></pre></td></tr></table></figure>

<p>二者的区别：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">作用域			定义位置		语法</span><br></pre></td></tr></table></figure>

<p>用户变量    当前会话        会话的任何地方        加@符号，不用指定类型<br>局部变量    定义它的BEGIN END中     BEGIN END的第一句话    一般不用加@,需要指定类型</p>
<p>###分支<br>一、if函数<br>    语法：if(条件，值1，值2)<br>    特点：可以用在任何位置</p>
<p>二、case语句</p>
<p>语法：</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">情况一：类似于switch</span><br><span class="line"><span class="keyword">case</span> 表达式</span><br><span class="line"><span class="keyword">when</span> 值<span class="number">1</span> <span class="keyword">then</span> 结果<span class="number">1</span>或语句<span class="number">1</span>(如果是语句，需要加分号) </span><br><span class="line"><span class="keyword">when</span> 值<span class="number">2</span> <span class="keyword">then</span> 结果<span class="number">2</span>或语句<span class="number">2</span>(如果是语句，需要加分号)</span><br><span class="line">...</span><br><span class="line"><span class="keyword">else</span> 结果n或语句n(如果是语句，需要加分号)</span><br><span class="line"><span class="keyword">end</span> 【<span class="keyword">case</span>】（如果是放在<span class="keyword">begin</span> <span class="keyword">end</span>中需要加上<span class="keyword">case</span>，如果放在<span class="keyword">select</span>后面不需要）</span><br><span class="line"></span><br><span class="line">情况二：类似于多重<span class="keyword">if</span></span><br><span class="line"><span class="keyword">case</span> </span><br><span class="line"><span class="keyword">when</span> 条件<span class="number">1</span> <span class="keyword">then</span> 结果<span class="number">1</span>或语句<span class="number">1</span>(如果是语句，需要加分号) </span><br><span class="line"><span class="keyword">when</span> 条件<span class="number">2</span> <span class="keyword">then</span> 结果<span class="number">2</span>或语句<span class="number">2</span>(如果是语句，需要加分号)</span><br><span class="line">...</span><br><span class="line"><span class="keyword">else</span> 结果n或语句n(如果是语句，需要加分号)</span><br><span class="line"><span class="keyword">end</span> 【<span class="keyword">case</span>】（如果是放在<span class="keyword">begin</span> <span class="keyword">end</span>中需要加上<span class="keyword">case</span>，如果放在<span class="keyword">select</span>后面不需要）</span><br></pre></td></tr></table></figure>

<p>特点：<br>    可以用在任何位置</p>
<p>三、if elseif语句</p>
<p>语法：</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> 情况<span class="number">1</span> then 语句<span class="number">1</span>;</span><br><span class="line">elseif 情况<span class="number">2</span> then 语句<span class="number">2</span>;</span><br><span class="line">...</span><br><span class="line"><span class="keyword">else</span> 语句n;</span><br><span class="line">end <span class="keyword">if</span>;</span><br></pre></td></tr></table></figure>

<p>特点：<br>    只能用在begin end中！！！！！！！！！！！！！！！</p>
<p>三者比较：<br>            应用场合<br>    if函数        简单双分支<br>    case结构    等值判断 的多分支<br>    if结构        区间判断 的多分支</p>
<p>###循环</p>
<p>语法：</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">【标签：】<span class="keyword">WHILE</span> 循环条件  <span class="keyword">DO</span></span><br><span class="line">	循环体</span><br><span class="line"><span class="keyword">END</span> <span class="keyword">WHILE</span> 【标签】;</span><br></pre></td></tr></table></figure>

<p>特点：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">只能放在<span class="keyword">BEGIN</span> <span class="keyword">END</span>里面</span><br><span class="line"></span><br><span class="line">如果要搭配leave跳转语句，需要使用标签，否则可以不用标签</span><br><span class="line"></span><br><span class="line">leave类似于java中的<span class="keyword">break</span>语句，跳出所在循环！！！</span><br></pre></td></tr></table></figure>

<h1 id="DCL-数据控制，事务，权限"><a href="#DCL-数据控制，事务，权限" class="headerlink" title="DCL,数据控制，事务，权限"></a>DCL,数据控制，事务，权限</h1><p>DCL,数据控制语言</p>
<p>数据控制语言DCL用来授予或回收访问数据库的某种特权，并控制<strong>数据库操纵事务发生的时间及效果</strong>，对数据库实行监视等。如：</p>
<p>1) GRANT：授权。<br>2) ROLLBACK [WORK] TO [SAVEPOINT]：回退到某一点。回滚—ROLLBACK回滚命令使数据库状态回到上次最后提交的状态。其格式为：SQL&gt;ROLLBACK;<br>3) COMMIT [WORK]：提交。在数据库的插入、删除和修改操作时，只有当事务在提交到数据库时才算完成。在事务提交前，只有操作数据库的这个人才能有权看到所做的事情，别人只有在最后提交完成后才可以看到。提交数据有三种类型：显式提交、隐式提交及自动提交。下面分别说明这三种类型。</p>
<p>(1) 显式提交<br>用COMMIT命令直接完成的提交为显式提交。其格式为：SQL&gt;COMMIT；</p>
<p>(2) 隐式提交<br>用SQL命令间接完成的提交为隐式提交。这些命令是：ALTER，AUDIT，COMMENT，CONNECT，CREATE，DISCONNECT，DROP，EXIT，GRANT，NOAUDIT，QUIT，REVOKE，RENAME。</p>
<p>(3) 自动提交<br>若把AUTOCOMMIT设置为ON，则在插入、修改、删除语句执行后，系统将自动进行提交，这就是自动提交。其格式为：SQL&gt;SET AUTOCOMMIT ON；</p>
<h2 id="事务管理"><a href="#事务管理" class="headerlink" title="事务管理"></a>事务管理</h2><p>基本术语:</p>
<ul>
<li>事务(transaction)指一组 SQL 语句；</li>
<li>回退(rollback)指撤销指定 SQL 语句的过程；</li>
<li>提交(commit)指将未存储的 SQL 语句结果写入数据库表；</li>
<li>保留点(savepoint)指事务处理中设置的临时占位符(placeholder)，你可以<strong>对它发布回退(与回退整个事务处理不同)。</strong></li>
</ul>
<p>不能回退 SELECT 语句，回退 SELECT 语句也没意义；也不能回退 CREATE 和 DROP 语句。</p>
<p>MySQL 的事务提交默认是<strong>隐式提交</strong>，每执行一条语句<strong>就把这条语句当成一个事务然后进行提交</strong>。当出现 <code>START TRANSACTION</code> 语句时，<strong>会关闭隐式提交</strong>；当 <code>COMMIT 或 ROLLBACK</code> 语句执行后，<strong>事务会自动关闭，重新恢复隐式提交。</strong></p>
<p>通过<strong>设置 autocommit 为 0 可以取消自动提交</strong>；autocommit 标记是<strong>针对每个连接</strong>而不是针对服务器的。</p>
<p>如果没有设置保留点，ROLLBACK 会回退到 START TRANSACTION 语句处；如果设置了保留点，并且在 <strong>ROLLBACK 中指定该保留点</strong>，则会<strong>回退到该保留点</strong>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">START TRANSACTION</span><br><span class="line">// ...</span><br><span class="line">SAVEPOINT delete1</span><br><span class="line">// ...</span><br><span class="line">ROLLBACK TO delete1</span><br><span class="line">// ...</span><br><span class="line">COMMIT</span><br></pre></td></tr></table></figure>

<h2 id="数据库事务"><a href="#数据库事务" class="headerlink" title="数据库事务"></a>数据库事务</h2><h3 id="含义"><a href="#含义" class="headerlink" title="含义"></a>含义</h3><p>​    通过一组逻辑操作单元（一组DML——sql语句），将数据从一种状态切换到另外一种状态</p>
<h3 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h3><p>​    （ACID）</p>
<ul>
<li>原子性：要么都执行，要么都回滚</li>
<li>一致性：保证数据的状态操作前和操作后保持一致</li>
<li>隔离性：多个事务同时操作相同数据库的同一个数据时，一个事务的执行不受另外一个事务的干扰</li>
<li>持久性：一个事务一旦提交，则数据将持久化到本地，除非其他事务对其进行修改</li>
</ul>
<p>相关步骤：</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>、开启事务</span><br><span class="line"><span class="number">2</span>、编写事务的一组逻辑操作单元（多条sql语句）</span><br><span class="line"><span class="number">3</span>、提交事务或回滚事务</span><br></pre></td></tr></table></figure>

<h3 id="事务的分类："><a href="#事务的分类：" class="headerlink" title="事务的分类："></a>事务的分类：</h3><p>隐式事务，没有明显的开启和结束事务的标志</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">比如</span><br><span class="line"><span class="keyword">insert</span>、<span class="keyword">update</span>、<span class="keyword">delete</span>语句本身就是一个事务</span><br></pre></td></tr></table></figure>

<p>显式事务，具有明显的开启和结束事务的标志</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>、开启事务</span><br><span class="line">取消自动提交事务的功能</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>、编写事务的一组逻辑操作单元（多条<span class="keyword">sql</span>语句）</span><br><span class="line"><span class="keyword">insert</span></span><br><span class="line"><span class="keyword">update</span></span><br><span class="line"><span class="keyword">delete</span></span><br><span class="line"></span><br><span class="line"><span class="number">3</span>、提交事务或回滚事务</span><br></pre></td></tr></table></figure>

<h3 id="使用到的关键字"><a href="#使用到的关键字" class="headerlink" title="使用到的关键字"></a>使用到的关键字</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> autocommit=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">start</span> <span class="keyword">transaction</span>;</span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"><span class="keyword">rollback</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">savepoint</span>  断点</span><br><span class="line"><span class="keyword">commit</span> <span class="keyword">to</span> 断点</span><br><span class="line"><span class="keyword">rollback</span> <span class="keyword">to</span> 断点</span><br></pre></td></tr></table></figure>

<h3 id="事务的隔离级别"><a href="#事务的隔离级别" class="headerlink" title="事务的隔离级别:"></a>事务的隔离级别:</h3><p>事务并发问题如何发生？</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">当多个事务同时操作同一个数据库的相同数据时</span><br></pre></td></tr></table></figure>

<p>事务的并发问题有哪些？</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">脏读：一个事务读取到了另外一个事务未提交的数据</span><br><span class="line">不可重复读：同一个事务中，多次读取到的数据不一致</span><br><span class="line">幻读：一个事务读取数据时，另外一个事务进行更新，导致第一个事务读取到了没有更新的数据</span><br></pre></td></tr></table></figure>

<p>如何避免事务的并发问题？</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">通过设置事务的隔离级别</span><br><span class="line"><span class="number">1</span>、<span class="keyword">READ</span> <span class="keyword">UNCOMMITTED</span></span><br><span class="line"><span class="number">2</span>、<span class="keyword">READ</span> <span class="keyword">COMMITTED</span> 可以避免脏读</span><br><span class="line"><span class="number">3</span>、<span class="keyword">REPEATABLE</span> <span class="keyword">READ</span> 可以避免脏读、不可重复读和一部分幻读</span><br><span class="line"><span class="number">4</span>、<span class="keyword">SERIALIZABLE</span>可以避免脏读、不可重复读和幻读</span><br></pre></td></tr></table></figure>

<p>设置隔离级别：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> <span class="keyword">session</span>|<span class="keyword">global</span>  <span class="keyword">transaction</span> <span class="keyword">isolation</span> <span class="keyword">level</span> 隔离级别名;</span><br></pre></td></tr></table></figure>

<p>查看隔离级别：</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> @<span class="symbol">@tx_isolation</span><span class="comment">;</span></span><br></pre></td></tr></table></figure>

<p>著作权归<a href="https://pdai.tech所有。" target="_blank" rel="noopener">https://pdai.tech所有。</a> 链接：<a href="https://pdai.tech/md/db/sql-lan/sql-lan.html" target="_blank" rel="noopener">https://pdai.tech/md/db/sql-lan/sql-lan.html</a></p>
<h2 id="权限管理"><a href="#权限管理" class="headerlink" title="权限管理"></a>权限管理</h2><p>MySQL 的账户信息保存在 mysql 这个数据库中。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">USE</span> mysql;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">user</span> <span class="keyword">FROM</span> <span class="keyword">user</span>;</span><br></pre></td></tr></table></figure>

<p><strong>创建账户</strong></p>
<p>新创建的账户没有任何权限。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> myuser <span class="keyword">IDENTIFIED</span> <span class="keyword">BY</span> <span class="string">'mypassword'</span>;</span><br></pre></td></tr></table></figure>

<p><strong>修改账户名</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RENAME myuser TO newuser;</span><br></pre></td></tr></table></figure>

<p><strong>删除账户</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">USER</span> myuser;</span><br></pre></td></tr></table></figure>

<p><strong>查看权限</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHOW GRANTS FOR myuser;</span><br></pre></td></tr></table></figure>

<p><strong>授予权限</strong></p>
<p>账户用 username@host 的形式定义，username@% 使用的是默认主机名。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GRANT SELECT, INSERT ON mydatabase.* TO myuser;</span><br></pre></td></tr></table></figure>

<p><strong>删除权限</strong></p>
<p>GRANT 和 REVOKE 可在几个层次上控制访问权限:</p>
<ul>
<li>整个服务器，使用 GRANT ALL 和 REVOKE ALL；</li>
<li>整个数据库，使用 ON database.*；</li>
<li>特定的表，使用 ON database.table；</li>
<li>特定的列；</li>
<li>特定的存储过程。</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">REVOKE</span> <span class="keyword">SELECT</span>, <span class="keyword">INSERT</span> <span class="keyword">ON</span> mydatabase.* <span class="keyword">FROM</span> myuser;</span><br></pre></td></tr></table></figure>

<p><strong>更改密码</strong></p>
<p>必须使用 Password() 函数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SET</span> PASSWROD <span class="keyword">FOR</span> myuser = <span class="keyword">Password</span>(<span class="string">'new_password'</span>);</span><br></pre></td></tr></table></figure>

<h1 id="SQL语言-SQL语句练习"><a href="#SQL语言-SQL语句练习" class="headerlink" title="SQL语言 - SQL语句练习"></a>SQL语言 - SQL语句练习</h1><p><a href="https://pdai.tech/md/db/sql-lan/sql-lan-pratice.html" target="_blank" rel="noopener">SQL语言 - SQL语句练习</a></p>
<p><a href="https://leetcode-cn.com/problemset/database/" target="_blank" rel="noopener">leetcode数据库相关练习</a></p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">,[<span class="number">2</span>,<span class="number">200</span>],[<span class="number">3</span>,<span class="number">300</span>]</span><br></pre></td></tr></table></figure>

<h2 id="查看第N高的数据，没有则返回为null"><a href="#查看第N高的数据，没有则返回为null" class="headerlink" title="查看第N高的数据，没有则返回为null"></a>查看第N高的数据，没有则返回为null</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">/*临时表解决null问题</span><br><span class="line">select NULL，返回null值</span><br><span class="line">n为数值</span><br><span class="line">*/</span><br><span class="line">SELECT</span><br><span class="line">    (SELECT DISTINCT salary AS SecondHighestSalary </span><br><span class="line">    FROM Employee ORDER BY salary DESC LIMIT n-1,1)</span><br><span class="line">    AS SecondHighestSalary</span><br></pre></td></tr></table></figure>

<h1 id="SQL语言-SQL语句优化"><a href="#SQL语言-SQL语句优化" class="headerlink" title="SQL语言 - SQL语句优化"></a>SQL语言 - SQL语句优化</h1><blockquote>
<p>最后，再总结一些SQL语句的优化建议。@pdai</p>
</blockquote>
<ul>
<li>SQL语言 - SQL语句优化<ul>
<li><a href="#负向查询不能使用索引">负向查询不能使用索引</a></li>
<li><a href="#前导模糊查询不能使用索引">前导模糊查询不能使用索引</a></li>
<li><a href="#数据区分不明显的不建议创建索引">数据区分不明显的不建议创建索引</a></li>
<li><a href="#字段的默认值不要为-null">字段的默认值不要为 null</a></li>
<li><a href="#在字段上进行计算不能命中索引">在字段上进行计算不能命中索引</a></li>
<li><a href="#最左前缀问题">最左前缀问题</a></li>
<li><a href="#如果明确知道只有一条记录返回">如果明确知道只有一条记录返回</a></li>
<li><a href="#不要让数据库帮我们做强制类型转换">不要让数据库帮我们做强制类型转换</a></li>
<li><a href="#如果需要进行-join-的字段两表的字段类型要相同">如果需要进行 join 的字段两表的字段类型要相同</a></li>
</ul>
</li>
<li><a href="#参考">参考</a></li>
</ul>
<h2 id="¶-负向查询不能使用索引"><a href="#¶-负向查询不能使用索引" class="headerlink" title="¶ 负向查询不能使用索引"></a><a href="#负向查询不能使用索引">¶</a> 负向查询不能使用索引</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">name</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> <span class="keyword">id</span> <span class="keyword">not</span> <span class="keyword">in</span> (<span class="number">1</span>,<span class="number">3</span>,<span class="number">4</span>);</span><br><span class="line">  </span><br><span class="line">        @pdai: 代码已经复制到剪贴板</span><br></pre></td></tr></table></figure>

<p>1</p>
<p>应该修改为:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select name from user where id in (2,5,6);</span><br><span class="line">  </span><br><span class="line">        @pdai: 代码已经复制到剪贴板</span><br></pre></td></tr></table></figure>

<p>1</p>
<h2 id="¶-前导模糊查询不能使用索引"><a href="#¶-前导模糊查询不能使用索引" class="headerlink" title="¶ 前导模糊查询不能使用索引"></a><a href="#前导模糊查询不能使用索引">¶</a> 前导模糊查询不能使用索引</h2><p>如:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">name</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> <span class="keyword">name</span> <span class="keyword">like</span> <span class="string">'%zhangsan'</span></span><br><span class="line">  </span><br><span class="line">        @pdai: 代码已经复制到剪贴板</span><br></pre></td></tr></table></figure>

<p>1</p>
<p>非前导则可以:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">name</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> <span class="keyword">name</span> <span class="keyword">like</span> <span class="string">'zhangsan%'</span></span><br><span class="line">  </span><br><span class="line">        @pdai: 代码已经复制到剪贴板</span><br></pre></td></tr></table></figure>

<p>1</p>
<p>建议可以考虑使用 <code>Lucene</code> 等全文索引工具来代替频繁的模糊查询。</p>
<h2 id="¶-数据区分不明显的不建议创建索引"><a href="#¶-数据区分不明显的不建议创建索引" class="headerlink" title="¶ 数据区分不明显的不建议创建索引"></a><a href="#数据区分不明显的不建议创建索引">¶</a> 数据区分不明显的不建议创建索引</h2><p>如 user 表中的性别字段，可以明显区分的才建议创建索引，如身份证等字段。</p>
<h2 id="¶-字段的默认值不要为-null"><a href="#¶-字段的默认值不要为-null" class="headerlink" title="¶ 字段的默认值不要为 null"></a><a href="#字段的默认值不要为-null">¶</a> 字段的默认值不要为 null</h2><p>这样会带来和预期不一致的查询结果。</p>
<h2 id="¶-在字段上进行计算不能命中索引"><a href="#¶-在字段上进行计算不能命中索引" class="headerlink" title="¶ 在字段上进行计算不能命中索引"></a><a href="#在字段上进行计算不能命中索引">¶</a> 在字段上进行计算不能命中索引</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">name</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> FROM_UNIXTIME(create_time) &lt; <span class="keyword">CURDATE</span>();</span><br><span class="line">  </span><br><span class="line">        @pdai: 代码已经复制到剪贴板</span><br></pre></td></tr></table></figure>

<p>1</p>
<p>应该修改为:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">name</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> create_time &lt; FROM_UNIXTIME(<span class="keyword">CURDATE</span>());</span><br><span class="line">  </span><br><span class="line">        @pdai: 代码已经复制到剪贴板</span><br></pre></td></tr></table></figure>

<p>1</p>
<h2 id="¶-最左前缀问题"><a href="#¶-最左前缀问题" class="headerlink" title="¶ 最左前缀问题"></a><a href="#最左前缀问题">¶</a> 最左前缀问题</h2><p>如果给 user 表中的 username pwd 字段创建了复合索引那么使用以下SQL 都是可以命中索引:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> username <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> username=<span class="string">'zhangsan'</span> <span class="keyword">and</span> pwd =<span class="string">'axsedf1sd'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> username <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> pwd =<span class="string">'axsedf1sd'</span> <span class="keyword">and</span> username=<span class="string">'zhangsan'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> username <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> username=<span class="string">'zhangsan'</span></span><br><span class="line">  </span><br><span class="line">        @pdai: 代码已经复制到剪贴板</span><br></pre></td></tr></table></figure>

<p>1<br>2<br>3<br>4<br>5</p>
<p>但是使用</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> username <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> pwd =<span class="string">'axsedf1sd'</span></span><br><span class="line">  </span><br><span class="line">        @pdai: 代码已经复制到剪贴板</span><br></pre></td></tr></table></figure>

<p>是不能命中索引的。</p>
<h2 id="¶-如果明确知道只有一条记录返回"><a href="#¶-如果明确知道只有一条记录返回" class="headerlink" title="¶ 如果明确知道只有一条记录返回"></a><a href="#如果明确知道只有一条记录返回">¶</a> 如果明确知道只有一条记录返回</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">name</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> username=<span class="string">'zhangsan'</span> <span class="keyword">limit</span> <span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>可以提高效率，可以让数据库停止游标移动。</p>
<h2 id="¶-不要让数据库帮我们做强制类型转换"><a href="#¶-不要让数据库帮我们做强制类型转换" class="headerlink" title="¶ 不要让数据库帮我们做强制类型转换"></a><a href="#不要让数据库帮我们做强制类型转换">¶</a> 不要让数据库帮我们做强制类型转换</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">name</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> telno=<span class="number">18722222222</span></span><br></pre></td></tr></table></figure>

<p>这样虽然可以查出数据，但是会导致全表扫描。</p>
<p>需要修改为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select name from user where telno=&apos;18722222222&apos;</span><br></pre></td></tr></table></figure>

<h2 id="¶-如果需要进行-join-的字段两表的字段类型要相同"><a href="#¶-如果需要进行-join-的字段两表的字段类型要相同" class="headerlink" title="¶ 如果需要进行 join 的字段两表的字段类型要相同"></a><a href="#如果需要进行-join-的字段两表的字段类型要相同">¶</a> 如果需要进行 join 的字段两表的字段类型要相同</h2><p>不然也不会命中索引。</p>
<h2 id="¶-参考"><a href="#¶-参考" class="headerlink" title="¶ 参考"></a><a href="#参考">¶</a> 参考</h2><ul>
<li><a href="https://github.com/realpdai/JCSprout/blob/master/MD/SQL-optimization.md" target="_blank" rel="noopener">https://github.com/realpdai/JCSprout/blob/master/MD/SQL-optimization.md</a></li>
<li><a href="http://blog.csdn.net/u010003835/article/details/54381080" target="_blank" rel="noopener">http://blog.csdn.net/u010003835/article/details/54381080</a></li>
<li><ul>
<li><a href="https://mp.weixin.qq.com/s/BMQC2oJlhLoeBDtveXgHpw" target="_blank" rel="noopener">MySQL 大表优化方案</a></li>
</ul>
</li>
</ul>
<h1 id="SQL的常见命令"><a href="#SQL的常见命令" class="headerlink" title="SQL的常见命令"></a>SQL的常见命令</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">databases</span>； 查看所有的数据库</span><br><span class="line"><span class="keyword">use</span> 库名； 打开指定 的库</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">tables</span> ; 显示库中的所有表</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">tables</span> <span class="keyword">from</span> 库名;显示指定库中的所有表</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> 表名(</span><br><span class="line">	字段名 字段类型,	</span><br><span class="line">	字段名 字段类型</span><br><span class="line">); 创建表</span><br><span class="line"></span><br><span class="line">desc 表名; 查看指定表的结构</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> 表名;显示表中的所有数据</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">database</span> db_name</span><br></pre></td></tr></table></figure>

<h2 id="修改字段编码"><a href="#修改字段编码" class="headerlink" title="修改字段编码"></a>修改字段编码</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">database</span> <span class="keyword">name</span> <span class="built_in">character</span> <span class="keyword">set</span> utf8;<span class="comment">#修改数据库成utf8的.</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> <span class="keyword">type</span> <span class="built_in">character</span> <span class="keyword">set</span> utf8;<span class="comment">#修改表用utf8.</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> <span class="keyword">type</span> <span class="keyword">modify</span> type_name <span class="built_in">varchar</span>(<span class="number">50</span>) <span class="built_in">CHARACTER</span> <span class="keyword">SET</span> utf8;<span class="comment">#修改字段用utf8</span></span><br></pre></td></tr></table></figure>

<h1 id="mysqldump数据导出"><a href="#mysqldump数据导出" class="headerlink" title="mysqldump数据导出"></a>mysqldump数据导出</h1><h2 id="MySQL-mysqldump数据导出详解"><a href="#MySQL-mysqldump数据导出详解" class="headerlink" title="MySQL mysqldump数据导出详解"></a><a href="https://www.cnblogs.com/chenmh/p/5300370.html" target="_blank" rel="noopener">MySQL mysqldump数据导出详解</a></h2><p>mysqldump是导出数据过程中使用非常频繁的一个工具</p>
<p><strong>mysqldump备份</strong>：</p>
<p>mysqldump -u用户名 -p密码 -h主机 数据库 a -w “sql条件” –lock-all-tables &gt; 路径</p>
<p>案例：</p>
<p>mysqldump -uroot -p1234 -hlocalhost db1 a -w “id in (select id from b)” –lock-all-tables &gt; c:\aa.txt</p>
<p><strong>mysqldump还原</strong>：</p>
<p>mysqldump -u用户名 -p密码 -h主机 数据库 &lt; 路径</p>
<p>案例：</p>
<p>mysql -uroot -p1234 db1 &lt; c:\aa.txt</p>
<p><strong>mysqldump按条件导出</strong>：</p>
<p>mysqldump -u用户名 -p密码 -h主机 数据库  a –where “条件语句” –no-建表&gt; 路径</p>
<p>mysqldump -uroot -p1234 dbname a –where “tag=’88’” –no-create-info&gt; c:\a.sql</p>
<p><strong>mysqldump按导入</strong>：</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">mysqldump</span> -u用户名 -p密码 -h主机 数据库 &lt; 路径</span><br></pre></td></tr></table></figure>

<p>1.导出所有数据库</p>
<p>该命令会导出包括系统数据库在内的所有数据库</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">mysqldump</span> -uroot -proot --<span class="literal">all</span>-databases &gt;/tmp/<span class="literal">all</span>.sql</span><br></pre></td></tr></table></figure>

<p>2.导出db1、db2两个数据库的所有数据</p>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqldump -uroot -proot <span class="params">--databases</span> db1 db2 &gt;<span class="string">/tmp/user.sql</span></span><br></pre></td></tr></table></figure>

<p>3.导出db1中的a1、a2表</p>
<p>注意导出指定表只能针对一个数据库进行导出，且导出的内容中和导出数据库也不一样，导出指定表的导出文本中没有创建数据库的判断语句，只有删除表-创建表-导入数据</p>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqldump -uroot -proot <span class="params">--databases</span> db1 <span class="params">--tables</span> a1 a2  &gt;<span class="string">/tmp/db1.sql</span></span><br></pre></td></tr></table></figure>

<p>4.条件导出，导出db1表a1中id=1的数据</p>
<p>如果多个表的条件相同可以一次性导出多个表</p>
<p>字段是整形</p>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqldump -uroot -proot <span class="params">--databases</span> db1 <span class="params">--tables</span> a1 <span class="params">--where=</span>'id=1'  &gt;<span class="string">/tmp/a1.sql</span></span><br></pre></td></tr></table></figure>

<h1 id="my"><a href="#my" class="headerlink" title="my"></a>my</h1><h2 id="mysql安装"><a href="#mysql安装" class="headerlink" title="mysql安装"></a>mysql安装</h2><p>本文mysql的安装环境为win10 64位，mysql版本为MySQL5.7</p>
<p>1、运行 —— <a href="https://so.csdn.net/so/search?q=cmd&spm=1001.2101.3001.7020" target="_blank" rel="noopener">cmd</a> ,打开面板，切换到mysql安装的bin目录下</p>
<p><img src="https://img-blog.csdnimg.cn/20181121113205147.jpg" alt="img"></p>
<p>2、在<a href="https://so.csdn.net/so/search?q=命令行&spm=1001.2101.3001.7020" target="_blank" rel="noopener">命令行</a>输入 mysql -u root -p 登录 mysql，可以随意输入一个密码，返回”Can’t connect to MySQL server on localhost (10061)”错误</p>
<p><img src="https://img-blog.csdnimg.cn/20181121113324478.jpg" alt="img"></p>
<p>3、将mysql加入到Windows的服务中。切换到mysql安装目录下的bin文件夹，命令行运行”mysqld –install”</p>
<p><img src="https://img-blog.csdnimg.cn/20181121113528273.jpg" alt="img"></p>
<p>4、初始化mysql数据库，输入“mysqld –initialize –user=root –console”。最后面的 root@localhost后的文字为初始化后的root 密码，一定要记住</p>
<p><img src="https://img-blog.csdnimg.cn/20181121113628764.jpg" alt="img"></p>
<p>5、此时使用“net start mysql”成功启动msyql</p>
<p><img src="https://img-blog.csdnimg.cn/20181121113815360.jpg" alt="img"></p>
<p>6、用生成的密码登录mysql</p>
<p><img src="https://img-blog.csdnimg.cn/20181121113949992.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzM3OTg3MTUx,size_16,color_FFFFFF,t_70" alt="img"></p>
<p>7、通过“set password=password(‘root’)”修改密码。此处将root密码设置为root</p>
<p><img src="https://img-blog.csdnimg.cn/20181121114058832.jpg" alt="img"></p>
<p>mysql用户名、密码修改成功，均为 root</p>
<blockquote>
<p> 现在mysql密码 ：123456, 22-3-17</p>
</blockquote>
<h2 id="获取val最大值所在行的数据"><a href="#获取val最大值所在行的数据" class="headerlink" title="获取val最大值所在行的数据"></a>获取val最大值所在行的数据</h2><h3 id="方法一：子查询"><a href="#方法一：子查询" class="headerlink" title="方法一：子查询"></a>方法一：子查询</h3><p>首先，查找某<a href="https://so.csdn.net/so/search?q=字段&spm=1001.2101.3001.7020" target="_blank" rel="noopener">字段</a>的最大值</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">select</span> <span class="title">max</span>(<span class="params">weight</span>) <span class="keyword">from</span> apple</span>;</span><br></pre></td></tr></table></figure>

<p>接着，根据最大值，查找其所在行</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> apple <span class="keyword">where</span> weight =<span class="number">7888</span>;</span><br></pre></td></tr></table></figure>

<p>合并在一起就是</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> apple <span class="keyword">where</span> weight = (<span class="function"><span class="keyword">select</span> <span class="title">max</span>(<span class="params">weight</span>) <span class="keyword">from</span> apple)</span>;</span><br></pre></td></tr></table></figure>

<h3 id="方法二：GROUP-BY-LIMIT-1"><a href="#方法二：GROUP-BY-LIMIT-1" class="headerlink" title="方法二：GROUP BY +LIMIT 1"></a>方法二：GROUP BY +LIMIT 1</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from apple GROUP BY weight LIMIT 1</span><br></pre></td></tr></table></figure>

<h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><p>一、按name分组取val最大的值所在行的数据。–方法1：</p>
<p>select a.* from tb a where val = (select max(val) from tb where name = a.name) order by a.name</p>
<p>–方法2：</p>
<p>select a.* from tb a where not exists(select 1 from tb where name = a.name and val &gt; a.val)</p>
<p>–方法3：</p>
<p>select a.* from tb a,(select name,max(val) val from tb group by name) b where a.name = b.name and a.val = b.val order by a.name</p>
<p>–方法4：</p>
<p>select a.* from tb a inner join (select name , max(val) val from tb group by name) b on a.name = b.name and a.val = b.val order by a.name</p>
<p>–方法5</p>
<p>select a.* from tb a where 1 &gt; (select count(*) from tb where name = a.name and val &gt; a.val ) order by a.name<br>————————————————<br><a href="https://blog.csdn.net/weixin_34738099/article/details/113139549" target="_blank" rel="noopener">其他方法原文链接：</a></p>
<h2 id="mysql命令行执行sql文件"><a href="#mysql命令行执行sql文件" class="headerlink" title="mysql命令行执行sql文件"></a>mysql命令行执行sql文件</h2><p>说明：result.sql文件中是多条插入数据的sql语句。现将这些sql语句导入到数据库中，（不用打开文件拷贝然后粘贴执行，如果数据量大的话这种操作非常繁琐，应使用以下方法）。<br>注：提前将文件拷贝至当前目录下。如果文件不在当前目录，在source 后应加上文件的绝对路径<br>1、登录mysql</p>
<p>mysql -u root -p ;<br>1<br>2、输入密码，选择数据库</p>
<p>use my_database;<br>1<br>3、执行sql文件。</p>
<p>source result.sql ;</p>
<h2 id="修改时区"><a href="#修改时区" class="headerlink" title="修改时区"></a>修改时区</h2><p><strong>方法一：通过mysql命令行模式下动态修改</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">variables</span> <span class="keyword">like</span> <span class="string">"%time_zone%"</span>;</span><br></pre></td></tr></table></figure>

<p>查看时区</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">+``<span class="comment">------------------+--------+</span></span><br><span class="line">| Variable_name  | Value |</span><br><span class="line">+``<span class="comment">------------------+--------+</span></span><br><span class="line">| system_time_zone | CST  |</span><br><span class="line">| time_zone    | SYSTEM |</span><br><span class="line">+``<span class="comment">------------------+--------+</span></span><br><span class="line">2 ``rows` `in` `<span class="keyword">set</span><span class="string">` `</span>(<span class="number">0.00</span> sec)</span><br><span class="line"><span class="comment">#time_zone说明mysql使用system的时区，system_time_zone说明system使用CST时区</span></span><br></pre></td></tr></table></figure>



<p>修改时区</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; set global time_zone = '+8:00'; ##修改mysql全局时区为北京时间，即我们所在的东8区</span><br><span class="line">&gt; set time_zone = '+8:00'; ##修改当前会话时区</span><br><span class="line">&gt; flush privileges; #立即生效</span><br></pre></td></tr></table></figure>



<h2 id="my-other"><a href="#my-other" class="headerlink" title="my other"></a>my other</h2><h4 id="mysql-jdbc-参数"><a href="#mysql-jdbc-参数" class="headerlink" title="mysql jdbc 参数"></a>mysql jdbc 参数</h4><p>MySQL Connector/J Driver</p>
<p>驱动程序包名：mysql-connector-java-x.x.xx-bin.jar</p>
<p>驱动程序类名: com.mysql.jdbc.Driver</p>
<p>JDBC URL: jdbc:mysql://<host>:<port>/<database_name></database_name></port></host></p>
<p>默认端口3306，如果服务器使用默认端口则port可以省略</p>
<p>MySQL Connector/J Driver 允许在URL中添加额外的连接属性</p>
<p>jdbc:mysql://<host>:<port>/<database_name>?property1=value1&amp;property2=value2</database_name></port></host></p>
<p>注意： 需要操作记录为了避免乱码应该加上属性 useUnicode=true&amp;characterEncoding=utf8 ，比如</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">jdbc:</span><span class="string">mysql:</span><span class="comment">//192.168.177.129:3306/report?useUnicode=true&amp;characterEncoding=utf8</span></span><br></pre></td></tr></table></figure>

<h4 id="mysql环境变量"><a href="#mysql环境变量" class="headerlink" title="mysql环境变量"></a>mysql环境变量</h4><p>如果添加到环境变量中还是无效，建议将mysql环境变量放在path路径的最前面</p>
<p>windows的<strong>path路径是通过path文本从前往后找</strong>，如果在最后有可能解析path失败</p>
<h2 id="mysql执行脚本命令"><a href="#mysql执行脚本命令" class="headerlink" title="mysql执行脚本命令"></a>mysql执行脚本命令</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">show databases; </span><br><span class="line"></span><br><span class="line">create database xxx;</span><br><span class="line"></span><br><span class="line">mysql&gt; use yoj;</span><br><span class="line"></span><br><span class="line">show tables;</span><br><span class="line"></span><br><span class="line">##需要先选择数据库</span><br><span class="line">source xxx.sql(sql文件的目录);</span><br></pre></td></tr></table></figure>

<h2 id="mysql注意"><a href="#mysql注意" class="headerlink" title="mysql注意"></a>mysql注意</h2><h4 id="null的判断都必须用is，-没有用"><a href="#null的判断都必须用is，-没有用" class="headerlink" title="null的判断都必须用is， = 没有用"></a>null的判断都必须用is， = 没有用</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> solution <span class="keyword">where</span> submit_time <span class="keyword">is</span> <span class="literal">Null</span></span><br></pre></td></tr></table></figure>

<h2 id="mysql导入数据时的外键约束问题"><a href="#mysql导入数据时的外键约束问题" class="headerlink" title="mysql导入数据时的外键约束问题"></a>mysql导入数据时的外键约束问题</h2><p> 这个问题可通过FOREIGN_KEY_CHECKS解决，用法如下：</p>
<pre><code>1、set FOREIGN_KEY_CHECKS=0;    #在导入的脚本命令行最前面设置为不检查外键约束
2、。。。。。。。。。。。。              #导入数据的命令行
3、set FOREIGN_KEY_CHECKS=1;    #在导入后恢复检查外键约束  </code></pre><h2 id="mysql-索引"><a href="#mysql-索引" class="headerlink" title="mysql 索引"></a>mysql 索引</h2><p><a href="https://blog.csdn.net/liutong123987/article/details/79384395" target="_blank" rel="noopener">https://blog.csdn.net/liutong123987/article/details/79384395</a></p>
<p>索引不仅能提高查询速度，还<strong>可以添加排序速度</strong>，如果order by 后面的语句用到了索引，那么将会提高排序的速度。</p>
<p>主键具备索引的功能了。 当你创建或设置主键的时候,mysql会自动添加一个与主键对应的唯一索引,不需要再做额外的添加。</p>
<h3 id="索引类型"><a href="#索引类型" class="headerlink" title="索引类型"></a>索引类型</h3><p>Mysql目前主要有以下几种索引类型：FULLTEXT，HASH，BTREE，RTREE。</p>
<h4 id="FULLTEXT"><a href="#FULLTEXT" class="headerlink" title="FULLTEXT"></a>FULLTEXT</h4><p>即为全文索引，目前只有MyISAM引擎支持。其可以在CREATE TABLE ，ALTER TABLE ，CREATE INDEX 使用，不过目前只有 CHAR、VARCHAR ，TEXT 列上可以创建全文索引。</p>
<p>全文索引并不是和MyISAM一起诞生的，它的出现是为了解决WHERE name LIKE “%word%”这类<strong>针对文本的模糊查询效率较低的问题。</strong></p>
<h4 id="HASH"><a href="#HASH" class="headerlink" title="HASH"></a>HASH</h4><p>  由于<strong>HASH的唯一（几乎100%的唯一）</strong>及类似键值对的形式，很适合作为索引。</p>
<p>HASH索引可以一次定位，不需要像树形索引那样逐层查找,因此<strong>具有极高的效率。</strong>但是，这种高效是有条件的，即<strong>只在“=”和“in”条件下高效，对于范围查询、排序及组合索引仍然效率不高。</strong></p>
<h4 id="BTREE"><a href="#BTREE" class="headerlink" title="BTREE"></a>BTREE</h4><p>BTREE索引就是一种将索引值按一定的算法，存入一个树形的数据结构中（二叉树），每次查询都是从树的入口root开始，依次遍历node，获取leaf。这是MySQL里默认和最常用的索引类型。</p>
<h4 id="RTREE"><a href="#RTREE" class="headerlink" title="RTREE"></a>RTREE</h4><p>   RTREE在MySQL很少使用，仅支持geometry数据类型，支持该类型的存储引擎只有MyISAM、BDb、InnoDb、NDb、Archive几种。</p>
<p>相对于BTREE，RTREE的优势在于范围查找。</p>
<p>ps. 此段详细内容见此片博文：Mysql几种索引类型的区别及适用情况</p>
<h3 id="三、索引种类"><a href="#三、索引种类" class="headerlink" title="三、索引种类"></a>三、索引种类</h3><p>普通索引：仅加速查询</p>
<p>唯一索引：加速查询 + 列值唯一（可以有null）</p>
<p>主键索引：加速查询 + 列值唯一（不可以有null）+ 表中只有一个</p>
<p>组合索引：多列值组成一个索引，专门用于组合搜索，其效率大于索引合并</p>
<p>全文索引：对文本的内容进行分词，进行搜索</p>
<h2 id="count-和count-1"><a href="#count-和count-1" class="headerlink" title="count(*)和count(1)"></a>count(*)和count(1)</h2><p><strong>如果你要统计行数就用<code>count(*)</code>或者<code>count(1)</code>，推荐前者</strong></p>
<p>如果要统计某个字段不为NULL值的个数就用<code>count(字段)</code></p>
<p>1.当mysql确认括号内的表达式值不可能为空时，实际上就是在统计行数</p>
<p>2.如果mysql知道某列col不可能为NULL值，那么mysql内部会将count(col)表达式优化为count(*)</p>
<p>这2句话出自<code>&lt;&lt;高性能MySQL&gt;&gt;</code>一书</p>
<p>也就是说count(1)和count(主键字段)还是要优化到count(*)的</p>
<h2 id="update使用select结果-count-distinct-xx"><a href="#update使用select结果-count-distinct-xx" class="headerlink" title="update使用select结果,count(distinct xx)"></a>update使用select结果,count(distinct xx)</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> <span class="keyword">user</span> <span class="keyword">SET</span> solved = (<span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(<span class="keyword">DISTINCT</span> problem_id) <span class="keyword">FROM</span> solution <span class="keyword">WHERE</span> user_id = <span class="comment">#&#123;userId&#125;) WHERE user_id = #&#123;userId&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="varchar-的长度问题"><a href="#varchar-的长度问题" class="headerlink" title="varchar()的长度问题"></a>varchar()的长度问题</h2><p>根据不同的字符集，解析中文占的位数是不一样的，如果是utf8的字符集，varchar(20)可以存放20个中文，这里中文跟英文存放的位数是一样的。但如果是latin字符集，中文估计解析不了，变成乱码</p>
<h2 id="mysql-导入时自己制定库名"><a href="#mysql-导入时自己制定库名" class="headerlink" title="mysql 导入时自己制定库名"></a>mysql 导入时自己制定库名</h2><p>在到处的sql文件中添加</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">DATABASE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> <span class="string">`ssm_crud`</span>;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> ssm_crud;</span><br><span class="line"><span class="keyword">USE</span> ssm_crud;</span><br></pre></td></tr></table></figure>

<h2 id="修改用户的密码"><a href="#修改用户的密码" class="headerlink" title="修改用户的密码"></a>修改用户的密码</h2><h2 id="方法1：-用SET-PASSWORD命令"><a href="#方法1：-用SET-PASSWORD命令" class="headerlink" title="方法1： 用SET PASSWORD命令"></a>方法1： 用SET PASSWORD命令</h2><p>首先登录MySQL。 </p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">格式：mysql&gt; <span class="keyword">set</span> <span class="keyword">password</span> <span class="keyword">for</span> 用户名@localhost = <span class="keyword">password</span>(<span class="string">'新密码'</span>); </span><br><span class="line">例子：mysql&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> <span class="keyword">password</span> <span class="keyword">for</span> root@localhost = <span class="keyword">password</span>(<span class="string">'123'</span>);</span><br></pre></td></tr></table></figure>

<h2 id="将表结构查询为表格"><a href="#将表结构查询为表格" class="headerlink" title="将表结构查询为表格"></a>将表结构查询为表格</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">  COLUMN_NAME 列名,</span><br><span class="line">  COLUMN_TYPE 数据类型,</span><br><span class="line">    DATA_TYPE 字段类型,</span><br><span class="line">  CHARACTER_MAXIMUM_LENGTH 长度,</span><br><span class="line">	IF(IS_NULLABLE = &apos;YES&apos;,&apos;是&apos;,&apos;否&apos;) AS &apos;是否为空&apos;,</span><br><span class="line">  COLUMN_DEFAULT 默认值, </span><br><span class="line">	IF(COLUMN_KEY=&apos;PRI&apos;,&apos;是&apos;,&apos;否&apos;) AS &apos;主键&apos;,</span><br><span class="line">	IF(COLUMN_KEY=&apos;MUL&apos;,&apos;是&apos;,&apos;否&apos;) AS &apos;外键&apos;,</span><br><span class="line">  COLUMN_COMMENT 备注,</span><br><span class="line">	COLUMN_KEY</span><br><span class="line">FROM</span><br><span class="line"> INFORMATION_SCHEMA.COLUMNS</span><br><span class="line">where</span><br><span class="line">-- yoj为数据库名称，到时候只需要修改成你要导出表结构的数据库即可</span><br><span class="line">table_schema =&apos;yoj&apos;</span><br><span class="line">AND</span><br><span class="line">-- user为表名，到时候换成你要导出的表的名称</span><br><span class="line">-- 如果不写的话，默认会查询出所有表中的数据，这样可能就分不清到底哪些字段是哪张表中的了，所以还是建议写上要导出的名名称</span><br><span class="line">table_name  = &apos;problem&apos;</span><br></pre></td></tr></table></figure>

<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p><a href="https://pdai.tech/md/db/sql-lan/sql-lan.html" target="_blank" rel="noopener"><strong>SQL语言 - SQL语法基础</strong></a></p>

    </div>

    
    
    
    
    <div>
     
      <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div>
    
</div>

     
    </div>
    
        
      
        <div id="reward-container">
  <div>坚持原创技术分享，您的支持将鼓励我继续创作！</div>
  <button id="reward-button" disable="enable" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    打赏
  </button>
  <div id="qr" style="display: none;">

  </div>
</div>

      
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>nicolas lee</li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://codeofli.github.io/2019/03/数据库/mysql/mysql/" title="mysql">https://codeofli.github.io/2019/03/数据库/mysql/mysql/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li>
</ul>
</div>

      

      <footer class="post-footer">
          
            
          
          <div class="post-tags">
            
              <a href="/tags/mysql/" rel="tag"># mysql</a>
            
          </div>
        

        

          <div class="post-nav">
            <div class="post-nav-next post-nav-item">
              
            </div>

            <span class="post-nav-divider"></span>

            <div class="post-nav-prev post-nav-item">
              
                <a href="/2019/09/hexo/hexo/" rel="prev" title="hexo">
                  hexo <i class="fa fa-chevron-right"></i>
                </a>
              
            </div>
          </div>
        
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">
        
        
        
        
      

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#数据库简介"><span class="nav-number">1.</span> <span class="nav-text">数据库简介</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#数据库相关概念"><span class="nav-number">1.1.</span> <span class="nav-text">数据库相关概念</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#数据库的好处"><span class="nav-number">1.1.1.</span> <span class="nav-text">数据库的好处</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#数据库相关概念-1"><span class="nav-number">1.1.2.</span> <span class="nav-text">数据库相关概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#数据库存储数据的特点"><span class="nav-number">1.1.3.</span> <span class="nav-text">数据库存储数据的特点</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MySQL产品的介绍和安装"><span class="nav-number">1.2.</span> <span class="nav-text">MySQL产品的介绍和安装</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#MySQL服务的启动和停止"><span class="nav-number">1.2.1.</span> <span class="nav-text">MySQL服务的启动和停止</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MySQL服务的登录和退出"><span class="nav-number">1.2.2.</span> <span class="nav-text">MySQL服务的登录和退出</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SQL的语言分类"><span class="nav-number">1.3.</span> <span class="nav-text">SQL的语言分类</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MySQL的语法规范"><span class="nav-number">1.4.</span> <span class="nav-text">MySQL的语法规范</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#查询-DQL语言"><span class="nav-number">2.</span> <span class="nav-text">查询-DQL语言</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#基础查询"><span class="nav-number">2.1.</span> <span class="nav-text">基础查询</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#DISTINCT"><span class="nav-number">2.1.1.</span> <span class="nav-text">DISTINCT</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#计算字段"><span class="nav-number">2.2.</span> <span class="nav-text">计算字段</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#条件查询"><span class="nav-number">2.3.</span> <span class="nav-text">条件查询</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1条件表达式"><span class="nav-number">2.3.1.</span> <span class="nav-text">1条件表达式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2逻辑表达式"><span class="nav-number">2.3.2.</span> <span class="nav-text">2逻辑表达式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3模糊查询"><span class="nav-number">2.3.3.</span> <span class="nav-text">3模糊查询</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#通配符"><span class="nav-number">2.3.3.1.</span> <span class="nav-text">通配符</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#排序查询"><span class="nav-number">2.4.</span> <span class="nav-text">排序查询</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#常见函数"><span class="nav-number">2.5.</span> <span class="nav-text">常见函数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1单行函数"><span class="nav-number">2.5.1.</span> <span class="nav-text">1单行函数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1、字符函数"><span class="nav-number">2.5.1.1.</span> <span class="nav-text">1、字符函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2数值函数"><span class="nav-number">2.5.1.2.</span> <span class="nav-text">2数值函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3日期函数"><span class="nav-number">2.5.1.3.</span> <span class="nav-text">3日期函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4、流程控制函数"><span class="nav-number">2.5.1.4.</span> <span class="nav-text">4、流程控制函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5、其他函数"><span class="nav-number">2.5.1.5.</span> <span class="nav-text">5、其他函数</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2分组-汇总，聚合-函数"><span class="nav-number">2.5.2.</span> <span class="nav-text">2分组(汇总，聚合)函数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#SQL-MAX-语法"><span class="nav-number">2.5.2.1.</span> <span class="nav-text">SQL MAX() 语法</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#分组查询"><span class="nav-number">2.6.</span> <span class="nav-text">分组查询</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#使用-WITH-ROLLUP"><span class="nav-number">2.6.1.</span> <span class="nav-text">使用 WITH ROLLUP</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#连接查询"><span class="nav-number">2.7.</span> <span class="nav-text">连接查询</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#内连接"><span class="nav-number">2.7.1.</span> <span class="nav-text">内连接</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#笛卡尔积"><span class="nav-number">2.7.1.1.</span> <span class="nav-text">笛卡尔积</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#¶-自连接"><span class="nav-number">2.7.2.</span> <span class="nav-text">¶ 自连接</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#¶-自然连接"><span class="nav-number">2.7.3.</span> <span class="nav-text">¶ 自然连接</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#¶-外连接"><span class="nav-number">2.7.4.</span> <span class="nav-text">¶ 外连接</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#总结"><span class="nav-number">2.7.5.</span> <span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#子查询"><span class="nav-number">2.8.</span> <span class="nav-text">子查询</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#含义："><span class="nav-number">2.8.1.</span> <span class="nav-text">含义：</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#分页查询"><span class="nav-number">2.9.</span> <span class="nav-text">分页查询</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#¶-LIMIT"><span class="nav-number">2.9.1.</span> <span class="nav-text">¶ LIMIT</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#offset"><span class="nav-number">2.9.2.</span> <span class="nav-text">offset</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#联合查询，组合查询"><span class="nav-number">2.10.</span> <span class="nav-text">联合查询，组合查询</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#视图"><span class="nav-number">3.</span> <span class="nav-text">视图</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#视图的创建"><span class="nav-number">3.0.1.</span> <span class="nav-text">视图的创建</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#视图的增删改查"><span class="nav-number">3.0.2.</span> <span class="nav-text">视图的增删改查</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#某些视图不能更新"><span class="nav-number">3.0.3.</span> <span class="nav-text">某些视图不能更新</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#视图逻辑的更新"><span class="nav-number">3.0.4.</span> <span class="nav-text">视图逻辑的更新</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#视图的删除"><span class="nav-number">3.0.5.</span> <span class="nav-text">视图的删除</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#视图结构的查看"><span class="nav-number">3.0.6.</span> <span class="nav-text">视图结构的查看</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#存储过程"><span class="nav-number">4.</span> <span class="nav-text">存储过程</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#创建存储过程"><span class="nav-number">4.1.</span> <span class="nav-text">创建存储过程</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#注意"><span class="nav-number">4.1.1.</span> <span class="nav-text">注意</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#调用存储过程"><span class="nav-number">4.2.</span> <span class="nav-text">调用存储过程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#用例"><span class="nav-number">4.3.</span> <span class="nav-text">用例</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#游标"><span class="nav-number">5.</span> <span class="nav-text">游标</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#触发器"><span class="nav-number">6.</span> <span class="nav-text">触发器</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#函数"><span class="nav-number">7.</span> <span class="nav-text">函数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#创建函数"><span class="nav-number">7.0.1.</span> <span class="nav-text">创建函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#调用函数"><span class="nav-number">7.0.2.</span> <span class="nav-text">调用函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#函数和存储过程的区别"><span class="nav-number">7.0.3.</span> <span class="nav-text">函数和存储过程的区别</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#字符集"><span class="nav-number">8.</span> <span class="nav-text">字符集</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#增删改，DML语言"><span class="nav-number">9.</span> <span class="nav-text">增删改，DML语言</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#插入"><span class="nav-number">9.1.</span> <span class="nav-text">插入</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#修改（更新）"><span class="nav-number">9.2.</span> <span class="nav-text">修改（更新）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#删除"><span class="nav-number">9.3.</span> <span class="nav-text">删除</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#定义-DDL语句，"><span class="nav-number">10.</span> <span class="nav-text">定义-DDL语句，</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#数据库、表的操作-命令"><span class="nav-number">10.1.</span> <span class="nav-text">数据库、表的操作(命令)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#修改表结构"><span class="nav-number">10.2.</span> <span class="nav-text">修改表结构</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#修改字段类型和列级约束"><span class="nav-number">10.2.1.</span> <span class="nav-text">修改字段类型和列级约束</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#唯一约束（UNIQUE-KEY）"><span class="nav-number">10.2.1.1.</span> <span class="nav-text">唯一约束（UNIQUE KEY）</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#在创建表时设置唯一约束"><span class="nav-number">10.2.1.1.1.</span> <span class="nav-text">在创建表时设置唯一约束</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#在修改表时添加唯一约束"><span class="nav-number">10.2.1.1.2.</span> <span class="nav-text">在修改表时添加唯一约束</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#库和表的管理"><span class="nav-number">10.3.</span> <span class="nav-text">库和表的管理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-修改表-alter"><span class="nav-number">10.4.</span> <span class="nav-text">2.修改表 alter</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#常见类型"><span class="nav-number">10.4.1.</span> <span class="nav-text">常见类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#常见约束"><span class="nav-number">10.4.2.</span> <span class="nav-text">常见约束</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#流程控制结构"><span class="nav-number">10.5.</span> <span class="nav-text">流程控制结构</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#系统变量"><span class="nav-number">10.5.1.</span> <span class="nav-text">系统变量</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#DCL-数据控制，事务，权限"><span class="nav-number">11.</span> <span class="nav-text">DCL,数据控制，事务，权限</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#事务管理"><span class="nav-number">11.1.</span> <span class="nav-text">事务管理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数据库事务"><span class="nav-number">11.2.</span> <span class="nav-text">数据库事务</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#含义"><span class="nav-number">11.2.1.</span> <span class="nav-text">含义</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#特点"><span class="nav-number">11.2.2.</span> <span class="nav-text">特点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#事务的分类："><span class="nav-number">11.2.3.</span> <span class="nav-text">事务的分类：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用到的关键字"><span class="nav-number">11.2.4.</span> <span class="nav-text">使用到的关键字</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#事务的隔离级别"><span class="nav-number">11.2.5.</span> <span class="nav-text">事务的隔离级别:</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#权限管理"><span class="nav-number">11.3.</span> <span class="nav-text">权限管理</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#SQL语言-SQL语句练习"><span class="nav-number">12.</span> <span class="nav-text">SQL语言 - SQL语句练习</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#查看第N高的数据，没有则返回为null"><span class="nav-number">12.1.</span> <span class="nav-text">查看第N高的数据，没有则返回为null</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#SQL语言-SQL语句优化"><span class="nav-number">13.</span> <span class="nav-text">SQL语言 - SQL语句优化</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#¶-负向查询不能使用索引"><span class="nav-number">13.1.</span> <span class="nav-text">¶ 负向查询不能使用索引</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#¶-前导模糊查询不能使用索引"><span class="nav-number">13.2.</span> <span class="nav-text">¶ 前导模糊查询不能使用索引</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#¶-数据区分不明显的不建议创建索引"><span class="nav-number">13.3.</span> <span class="nav-text">¶ 数据区分不明显的不建议创建索引</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#¶-字段的默认值不要为-null"><span class="nav-number">13.4.</span> <span class="nav-text">¶ 字段的默认值不要为 null</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#¶-在字段上进行计算不能命中索引"><span class="nav-number">13.5.</span> <span class="nav-text">¶ 在字段上进行计算不能命中索引</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#¶-最左前缀问题"><span class="nav-number">13.6.</span> <span class="nav-text">¶ 最左前缀问题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#¶-如果明确知道只有一条记录返回"><span class="nav-number">13.7.</span> <span class="nav-text">¶ 如果明确知道只有一条记录返回</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#¶-不要让数据库帮我们做强制类型转换"><span class="nav-number">13.8.</span> <span class="nav-text">¶ 不要让数据库帮我们做强制类型转换</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#¶-如果需要进行-join-的字段两表的字段类型要相同"><span class="nav-number">13.9.</span> <span class="nav-text">¶ 如果需要进行 join 的字段两表的字段类型要相同</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#¶-参考"><span class="nav-number">13.10.</span> <span class="nav-text">¶ 参考</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#SQL的常见命令"><span class="nav-number">14.</span> <span class="nav-text">SQL的常见命令</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#修改字段编码"><span class="nav-number">14.1.</span> <span class="nav-text">修改字段编码</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#mysqldump数据导出"><span class="nav-number">15.</span> <span class="nav-text">mysqldump数据导出</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#MySQL-mysqldump数据导出详解"><span class="nav-number">15.1.</span> <span class="nav-text">MySQL mysqldump数据导出详解</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#my"><span class="nav-number">16.</span> <span class="nav-text">my</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#mysql安装"><span class="nav-number">16.1.</span> <span class="nav-text">mysql安装</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#获取val最大值所在行的数据"><span class="nav-number">16.2.</span> <span class="nav-text">获取val最大值所在行的数据</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#方法一：子查询"><span class="nav-number">16.2.1.</span> <span class="nav-text">方法一：子查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#方法二：GROUP-BY-LIMIT-1"><span class="nav-number">16.2.2.</span> <span class="nav-text">方法二：GROUP BY +LIMIT 1</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#其他"><span class="nav-number">16.2.3.</span> <span class="nav-text">其他</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#mysql命令行执行sql文件"><span class="nav-number">16.3.</span> <span class="nav-text">mysql命令行执行sql文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#修改时区"><span class="nav-number">16.4.</span> <span class="nav-text">修改时区</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#my-other"><span class="nav-number">16.5.</span> <span class="nav-text">my other</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#mysql-jdbc-参数"><span class="nav-number">16.5.0.1.</span> <span class="nav-text">mysql jdbc 参数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#mysql环境变量"><span class="nav-number">16.5.0.2.</span> <span class="nav-text">mysql环境变量</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#mysql执行脚本命令"><span class="nav-number">16.6.</span> <span class="nav-text">mysql执行脚本命令</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#mysql注意"><span class="nav-number">16.7.</span> <span class="nav-text">mysql注意</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#null的判断都必须用is，-没有用"><span class="nav-number">16.7.0.1.</span> <span class="nav-text">null的判断都必须用is， = 没有用</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#mysql导入数据时的外键约束问题"><span class="nav-number">16.8.</span> <span class="nav-text">mysql导入数据时的外键约束问题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#mysql-索引"><span class="nav-number">16.9.</span> <span class="nav-text">mysql 索引</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#索引类型"><span class="nav-number">16.9.1.</span> <span class="nav-text">索引类型</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#FULLTEXT"><span class="nav-number">16.9.1.1.</span> <span class="nav-text">FULLTEXT</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#HASH"><span class="nav-number">16.9.1.2.</span> <span class="nav-text">HASH</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#BTREE"><span class="nav-number">16.9.1.3.</span> <span class="nav-text">BTREE</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#RTREE"><span class="nav-number">16.9.1.4.</span> <span class="nav-text">RTREE</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#三、索引种类"><span class="nav-number">16.9.2.</span> <span class="nav-text">三、索引种类</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#count-和count-1"><span class="nav-number">16.10.</span> <span class="nav-text">count(*)和count(1)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#update使用select结果-count-distinct-xx"><span class="nav-number">16.11.</span> <span class="nav-text">update使用select结果,count(distinct xx)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#varchar-的长度问题"><span class="nav-number">16.12.</span> <span class="nav-text">varchar()的长度问题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#mysql-导入时自己制定库名"><span class="nav-number">16.13.</span> <span class="nav-text">mysql 导入时自己制定库名</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#修改用户的密码"><span class="nav-number">16.14.</span> <span class="nav-text">修改用户的密码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#方法1：-用SET-PASSWORD命令"><span class="nav-number">16.15.</span> <span class="nav-text">方法1： 用SET PASSWORD命令</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#将表结构查询为表格"><span class="nav-number">16.16.</span> <span class="nav-text">将表结构查询为表格</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#参考资料"><span class="nav-number">17.</span> <span class="nav-text">参考资料</span></a></li></ol></div>
        
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image"
      src="/assets/img/avatar.jpg"
      alt="nicolas lee">
  <p class="site-author-name" itemprop="name">nicolas lee</p>
  <div class="site-description" itemprop="description">Yesterday you said tomorow.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        
          <a href="/archives/">
        
          <span class="site-state-item-count">40</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-categories">
        
          
            <a href="/categories/">
          
        
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">分类</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-tags">
        
          
            <a href="/tags/">
          
        
        <span class="site-state-item-count">29</span>
        <span class="site-state-item-name">标签</span>
        </a>
      </div>
    
  </nav>
</div>
  <div class="feed-link motion-element">
    <a href="/atom.xml" rel="alternate">
      <i class="fa fa-rss"></i>RSS
    </a>
  </div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <a href="https://github.com/codeOflI" title="GitHub &rarr; https://github.com/codeOflI" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
    
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <a href="https://blog.csdn.net/qq_42835910" title="CSDN &rarr; https://blog.csdn.net/qq_42835910" rel="noopener" target="_blank"><i class="fa fa-fw fa-crosshairs"></i>CSDN</a>
      </span>
    
  </div>
  <div class="cc-license motion-element" itemprop="license">
    
  
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2019 – <span itemprop="copyrightYear">2022</span>
  <span class="with-love" id="animate">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">nicolas lee</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
      <span class="post-meta-item-text">站点总字数：</span>
    
    <span title="站点总字数"></span>
</div>


        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
  
    <span class="post-meta-divider">|</span>
  
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
  
</div>












        
      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js?v=3.1.0"></script>
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
<script src="/js/utils.js?v=7.4.1"></script><script src="/js/motion.js?v=7.4.1"></script>
<script src="/js/schemes/pisces.js?v=7.4.1"></script>

<script src="/js/next-boot.js?v=7.4.1"></script>



  





















  

  

  

</body>
</html>
<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/src/clicklove.js"></script>